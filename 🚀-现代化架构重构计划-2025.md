# ğŸš€ ç°ä»£åŒ–æ¶æ„é‡æ„è®¡åˆ’

**åˆ›å»ºæ—¥æœŸ**: 2025-11-11
**ç›®æ ‡ç‰ˆæœ¬**: Go 1.25.3
**æ¶æ„ç›®æ ‡**: Clean Architecture + ç°ä»£åŒ–æŠ€æœ¯æ ˆ

---

## ğŸ¯ æŠ€æœ¯æ ˆæ¸…å•

### æ ¸å¿ƒæ¡†æ¶

- âœ… **Webæ¡†æ¶**: Chi, Echo
- âœ… **ORM**: Ent (Facebook å¼€æºï¼Œç±»å‹å®‰å…¨)
- âœ… **é…ç½®**: Viper
- âœ… **æ—¥å¿—**: Slog (Go 1.21+ æ ‡å‡†åº“)
- âœ… **ä¾èµ–æ³¨å…¥**: Wire (Google å®˜æ–¹)

### API ä¸é€šä¿¡

- âœ… **REST API**: OpenAPI 3.0 / Swagger
- âœ… **å¼‚æ­¥API**: AsyncAPI
- âœ… **GraphQL**: gqlgen æˆ– graphql-go
- âœ… **gRPC**: æ ‡å‡† gRPC
- âœ… **MQTT**: paho.mqtt.golang

### æ¶ˆæ¯é˜Ÿåˆ—

- âœ… **Kafka**: sarama æˆ– confluent-kafka-go

### æ•°æ®åº“

- âœ… **PostgreSQL**: pgx æˆ– lib/pq

### å¯è§‚æµ‹æ€§

- âœ… **OTLP**: OpenTelemetry (go.opentelemetry.io)
- âœ… **è¿½è¸ª**: OpenTelemetry Tracing
- âœ… **æŒ‡æ ‡**: OpenTelemetry Metrics
- âœ… **æ—¥å¿—**: OpenTelemetry Logs

### ç°ä»£æŠ€æœ¯

- âœ… **WASM**: WebAssembly æ”¯æŒ
- âœ… **eBPF**: cilium/ebpf

### å®¹å™¨åŒ–

- âœ… **Docker**: å¤šé˜¶æ®µæ„å»º
- âœ… **Kubernetes**: Helm Charts

---

## ğŸ“ æ–°é¡¹ç›®ç»“æ„ï¼ˆClean Architectureï¼‰

```text
golang/
â”œâ”€â”€ cmd/                              # ä¸»ç¨‹åºå…¥å£
â”‚   â”œâ”€â”€ server/                      # HTTP æœåŠ¡å™¨
â”‚   â”‚   â””â”€â”€ main.go
â”‚   â”œâ”€â”€ grpc-server/                 # gRPC æœåŠ¡å™¨
â”‚   â”‚   â””â”€â”€ main.go
â”‚   â”œâ”€â”€ graphql-server/              # GraphQL æœåŠ¡å™¨
â”‚   â”‚   â””â”€â”€ main.go
â”‚   â”œâ”€â”€ mqtt-client/                 # MQTT å®¢æˆ·ç«¯
â”‚   â”‚   â””â”€â”€ main.go
â”‚   â””â”€â”€ cli/                         # CLI å·¥å…·
â”‚       â””â”€â”€ main.go
â”‚
â”œâ”€â”€ internal/                        # ç§æœ‰åº”ç”¨ä»£ç ï¼ˆClean Architectureï¼‰
â”‚   â”œâ”€â”€ domain/                      # é¢†åŸŸå±‚ï¼ˆæ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼‰
â”‚   â”‚   â”œâ”€â”€ user/
â”‚   â”‚   â”‚   â”œâ”€â”€ entity.go           # å®ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ repository.go       # ä»“å‚¨æ¥å£
â”‚   â”‚   â”‚   â””â”€â”€ service.go          # é¢†åŸŸæœåŠ¡æ¥å£
â”‚   â”‚   â”œâ”€â”€ order/
â”‚   â”‚   â””â”€â”€ product/
â”‚   â”‚
â”‚   â”œâ”€â”€ application/                 # åº”ç”¨å±‚ï¼ˆç”¨ä¾‹/æœåŠ¡ï¼‰
â”‚   â”‚   â”œâ”€â”€ user/
â”‚   â”‚   â”‚   â”œâ”€â”€ service.go          # åº”ç”¨æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ dto.go              # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”‚   â”‚   â””â”€â”€ usecase.go          # ç”¨ä¾‹
â”‚   â”‚   â””â”€â”€ order/
â”‚   â”‚
â”‚   â”œâ”€â”€ infrastructure/              # åŸºç¡€è®¾æ–½å±‚
â”‚   â”‚   â”œâ”€â”€ database/
â”‚   â”‚   â”‚   â”œâ”€â”€ postgres/           # PostgreSQL å®ç°
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ connection.go
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ migrations/
â”‚   â”‚   â”‚   â””â”€â”€ ent/                # Ent å®¢æˆ·ç«¯
â”‚   â”‚   â”‚       â””â”€â”€ client.go
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ messaging/
â”‚   â”‚   â”‚   â”œâ”€â”€ kafka/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ producer.go
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ consumer.go
â”‚   â”‚   â”‚   â””â”€â”€ mqtt/
â”‚   â”‚   â”‚       â”œâ”€â”€ client.go
â”‚   â”‚   â”‚       â””â”€â”€ handler.go
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ cache/
â”‚   â”‚   â”‚   â””â”€â”€ redis.go
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ observability/
â”‚   â”‚       â”œâ”€â”€ otlp/
â”‚   â”‚       â”‚   â”œâ”€â”€ tracer.go
â”‚   â”‚       â”‚   â”œâ”€â”€ metrics.go
â”‚   â”‚       â”‚   â””â”€â”€ logger.go
â”‚   â”‚       â””â”€â”€ ebpf/
â”‚   â”‚           â””â”€â”€ collector.go
â”‚   â”‚
â”‚   â”œâ”€â”€ interfaces/                  # æ¥å£å±‚ï¼ˆPresentationï¼‰
â”‚   â”‚   â”œâ”€â”€ http/                   # HTTP æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ chi/                # Chi è·¯ç”±
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ router.go
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ middleware.go
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ handlers/
â”‚   â”‚   â”‚   â”‚       â”œâ”€â”€ user_handler.go
â”‚   â”‚   â”‚   â”‚       â””â”€â”€ order_handler.go
â”‚   â”‚   â”‚   â”œâ”€â”€ echo/               # Echo è·¯ç”±ï¼ˆå¤‡é€‰ï¼‰
â”‚   â”‚   â”‚   â””â”€â”€ openapi/            # OpenAPI è§„èŒƒ
â”‚   â”‚   â”‚       â””â”€â”€ spec.yaml
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ grpc/                   # gRPC æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ proto/              # Protocol Buffers
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ user.proto
â”‚   â”‚   â”‚   â”œâ”€â”€ server.go
â”‚   â”‚   â”‚   â””â”€â”€ handlers/
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ graphql/                # GraphQL æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ schema.graphql
â”‚   â”‚   â”‚   â”œâ”€â”€ resolver.go
â”‚   â”‚   â”‚   â””â”€â”€ generated.go
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ asyncapi/               # AsyncAPI è§„èŒƒ
â”‚   â”‚       â””â”€â”€ spec.yaml
â”‚   â”‚
â”‚   â””â”€â”€ config/                     # é…ç½®ç®¡ç†
â”‚       â”œâ”€â”€ config.go
â”‚       â”œâ”€â”€ viper.go
â”‚       â””â”€â”€ env.go
â”‚
â”œâ”€â”€ pkg/                            # å…¬å…±åº“ï¼ˆå¯è¢«å¤–éƒ¨å¼•ç”¨ï¼‰
â”‚   â”œâ”€â”€ errors/                     # é”™è¯¯å¤„ç†
â”‚   â”œâ”€â”€ validator/                  # éªŒè¯å™¨
â”‚   â”œâ”€â”€ logger/                     # æ—¥å¿—å°è£…
â”‚   â””â”€â”€ utils/                      # å·¥å…·å‡½æ•°
â”‚
â”œâ”€â”€ api/                            # API å®šä¹‰
â”‚   â”œâ”€â”€ openapi/
â”‚   â”‚   â””â”€â”€ openapi.yaml
â”‚   â”œâ”€â”€ asyncapi/
â”‚   â”‚   â””â”€â”€ asyncapi.yaml
â”‚   â””â”€â”€ graphql/
â”‚       â””â”€â”€ schema.graphql
â”‚
â”œâ”€â”€ deployments/                    # éƒ¨ç½²é…ç½®
â”‚   â”œâ”€â”€ docker/
â”‚   â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”‚   â”œâ”€â”€ Dockerfile.dev
â”‚   â”‚   â””â”€â”€ docker-compose.yml
â”‚   â”œâ”€â”€ kubernetes/
â”‚   â”‚   â”œâ”€â”€ deployment.yaml
â”‚   â”‚   â”œâ”€â”€ service.yaml
â”‚   â”‚   â””â”€â”€ helm/
â”‚   â”‚       â””â”€â”€ Chart.yaml
â”‚   â””â”€â”€ wasm/
â”‚       â””â”€â”€ build.sh
â”‚
â”œâ”€â”€ migrations/                     # æ•°æ®åº“è¿ç§»
â”‚   â”œâ”€â”€ postgres/
â”‚   â”‚   â”œâ”€â”€ 001_create_users.up.sql
â”‚   â”‚   â””â”€â”€ 001_create_users.down.sql
â”‚   â””â”€â”€ ent/
â”‚       â””â”€â”€ schema/
â”‚
â”œâ”€â”€ configs/                        # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ config.yaml
â”‚   â”œâ”€â”€ config.dev.yaml
â”‚   â”œâ”€â”€ config.prod.yaml
â”‚   â””â”€â”€ .env.example
â”‚
â”œâ”€â”€ scripts/                        # è„šæœ¬
â”‚   â”œâ”€â”€ wire/                       # Wire ä¾èµ–æ³¨å…¥
â”‚   â”‚   â””â”€â”€ wire.go
â”‚   â”œâ”€â”€ generate/                   # ä»£ç ç”Ÿæˆ
â”‚   â”‚   â”œâ”€â”€ ent.go
â”‚   â”‚   â”œâ”€â”€ graphql.go
â”‚   â”‚   â””â”€â”€ openapi.go
â”‚   â””â”€â”€ build/                      # æ„å»ºè„šæœ¬
â”‚
â”œâ”€â”€ test/                           # æµ‹è¯•
â”‚   â”œâ”€â”€ unit/                       # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ integration/                # é›†æˆæµ‹è¯•
â”‚   â”œâ”€â”€ e2e/                        # ç«¯åˆ°ç«¯æµ‹è¯•
â”‚   â””â”€â”€ fixtures/                   # æµ‹è¯•æ•°æ®
â”‚
â”œâ”€â”€ docs/                           # æ–‡æ¡£ï¼ˆé‡æ–°ç»„ç»‡ï¼‰
â”‚   â”œâ”€â”€ architecture/               # æ¶æ„æ–‡æ¡£
â”‚   â”‚   â”œâ”€â”€ clean-architecture.md
â”‚   â”‚   â”œâ”€â”€ domain-model.md
â”‚   â”‚   â””â”€â”€ api-design.md
â”‚   â”œâ”€â”€ guides/                     # å¼€å‘æŒ‡å—
â”‚   â”‚   â”œâ”€â”€ getting-started.md
â”‚   â”‚   â”œâ”€â”€ development.md
â”‚   â”‚   â””â”€â”€ testing.md
â”‚   â””â”€â”€ api/                        # API æ–‡æ¡£
â”‚       â”œâ”€â”€ rest.md
â”‚       â”œâ”€â”€ grpc.md
â”‚       â””â”€â”€ graphql.md
â”‚
â””â”€â”€ archive/                        # å½’æ¡£ï¼ˆæ—§ä»£ç å’Œæ–‡æ¡£ï¼‰
    â”œâ”€â”€ old-docs/
    â”œâ”€â”€ old-code/
    â””â”€â”€ legacy/
```

---

## ğŸ—ï¸ Clean Architecture åˆ†å±‚è¯´æ˜

### 1. Domain Layer (é¢†åŸŸå±‚)

- **èŒè´£**: æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œä¸ä¾èµ–ä»»ä½•å¤–éƒ¨æ¡†æ¶
- **åŒ…å«**: å®ä½“ã€å€¼å¯¹è±¡ã€é¢†åŸŸæœåŠ¡æ¥å£ã€ä»“å‚¨æ¥å£
- **è§„åˆ™**: ä¸èƒ½å¯¼å…¥ infrastructure æˆ– interfaces å±‚

```go
// internal/domain/user/entity.go
package user

type User struct {
    ID    string
    Email string
    Name  string
}

// internal/domain/user/repository.go
type Repository interface {
    Create(ctx context.Context, user *User) error
    FindByID(ctx context.Context, id string) (*User, error)
}
```

### 2. Application Layer (åº”ç”¨å±‚)

- **èŒè´£**: ç”¨ä¾‹ç¼–æ’ï¼Œåè°ƒé¢†åŸŸå¯¹è±¡
- **åŒ…å«**: åº”ç”¨æœåŠ¡ã€ç”¨ä¾‹ã€DTO
- **è§„åˆ™**: åªèƒ½å¯¼å…¥ domain å±‚

```go
// internal/application/user/service.go
package user

type Service struct {
    repo domain.UserRepository
}

func (s *Service) CreateUser(ctx context.Context, req CreateUserRequest) (*UserDTO, error) {
    // ç”¨ä¾‹é€»è¾‘
}
```

### 3. Infrastructure Layer (åŸºç¡€è®¾æ–½å±‚)

- **èŒè´£**: æŠ€æœ¯å®ç°ç»†èŠ‚
- **åŒ…å«**: æ•°æ®åº“ã€æ¶ˆæ¯é˜Ÿåˆ—ã€ç¼“å­˜ã€å¤–éƒ¨æœåŠ¡
- **è§„åˆ™**: å®ç° domain å±‚å®šä¹‰çš„æ¥å£

```go
// internal/infrastructure/database/postgres/user_repository.go
package postgres

type UserRepository struct {
    db *ent.Client
}

func (r *UserRepository) Create(ctx context.Context, user *domain.User) error {
    // Ent å®ç°
}
```

### 4. Interfaces Layer (æ¥å£å±‚)

- **èŒè´£**: å¤–éƒ¨æ¥å£é€‚é…
- **åŒ…å«**: HTTPã€gRPCã€GraphQLã€MQTT
- **è§„åˆ™**: è°ƒç”¨ application å±‚

```go
// internal/interfaces/http/chi/handlers/user_handler.go
package handlers

type UserHandler struct {
    service *application.UserService
}

func (h *UserHandler) CreateUser(w http.ResponseWriter, r *http.Request) {
    // HTTP å¤„ç†
}
```

---

## ğŸ“¦ ä¾èµ–ç®¡ç†

### go.mod ç¤ºä¾‹

```go
module github.com/yourusername/golang

go 1.25.3

require (
    // Web æ¡†æ¶
    github.com/go-chi/chi/v5 v5.0.10
    github.com/labstack/echo/v4 v4.11.3

    // ORM
    entgo.io/ent v0.12.5

    // é…ç½®
    github.com/spf13/viper v1.17.0

    // æ—¥å¿—
    // log/slog æ˜¯æ ‡å‡†åº“ï¼ŒGo 1.21+

    // ä¾èµ–æ³¨å…¥
    github.com/google/wire v0.5.0

    // æ•°æ®åº“
    github.com/jackc/pgx/v5 v5.5.0

    // gRPC
    google.golang.org/grpc v1.59.0
    google.golang.org/protobuf v1.31.0

    // GraphQL
    github.com/99designs/gqlgen v0.17.40

    // MQTT
    github.com/eclipse/paho.mqtt.golang v1.4.3

    // Kafka
    github.com/IBM/sarama v1.42.1

    // OpenTelemetry
    go.opentelemetry.io/otel v1.21.0
    go.opentelemetry.io/otel/trace v1.21.0
    go.opentelemetry.io/otel/metric v1.21.0
    go.opentelemetry.io/otel/exporters/otlp/otlptrace/otlptracegrpc v1.21.0
    go.opentelemetry.io/otel/exporters/otlp/otlpmetric/otlpmetricgrpc v1.21.0

    // eBPF
    github.com/cilium/ebpf v0.12.3

    // æµ‹è¯•
    github.com/stretchr/testify v1.8.4
)
```

---

## ğŸ§ª æµ‹è¯•é©±åŠ¨å¼€å‘ (TDD)

### æµ‹è¯•ç»“æ„

```text
test/
â”œâ”€â”€ unit/                           # å•å…ƒæµ‹è¯•
â”‚   â”œâ”€â”€ domain/
â”‚   â”œâ”€â”€ application/
â”‚   â””â”€â”€ infrastructure/
â”‚
â”œâ”€â”€ integration/                    # é›†æˆæµ‹è¯•
â”‚   â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ messaging/
â”‚   â””â”€â”€ api/
â”‚
â””â”€â”€ e2e/                           # ç«¯åˆ°ç«¯æµ‹è¯•
    â”œâ”€â”€ api/
    â””â”€â”€ workflows/
```

### TDD æµç¨‹

1. **Red**: ç¼–å†™å¤±è´¥çš„æµ‹è¯•
2. **Green**: ç¼–å†™æœ€å°å®ç°ä½¿æµ‹è¯•é€šè¿‡
3. **Refactor**: é‡æ„ä»£ç 

---

## ğŸ“‹ å®æ–½è®¡åˆ’

### Phase 1: é¡¹ç›®ç»“æ„é‡æ„ï¼ˆ1å‘¨ï¼‰

- [ ] åˆ›å»ºæ–°ç›®å½•ç»“æ„
- [ ] è¿ç§»ç°æœ‰ä»£ç åˆ°æ–°ç»“æ„
- [ ] å½’æ¡£æ—§ä»£ç å’Œæ–‡æ¡£

### Phase 2: Clean Architecture å®ç°ï¼ˆ2å‘¨ï¼‰

- [ ] å®šä¹‰ Domain å±‚
- [ ] å®ç° Application å±‚
- [ ] å®ç° Infrastructure å±‚
- [ ] å®ç° Interfaces å±‚

### Phase 3: æŠ€æœ¯æ ˆé›†æˆï¼ˆ3å‘¨ï¼‰

- [ ] é›†æˆ Chi/Echo
- [ ] é›†æˆ Ent (PostgreSQL)
- [ ] é›†æˆ Wire (ä¾èµ–æ³¨å…¥)
- [ ] é›†æˆ OpenTelemetry
- [ ] é›†æˆ Kafka/MQTT
- [ ] é›†æˆ gRPC
- [ ] é›†æˆ GraphQL

### Phase 4: æµ‹è¯•å’Œæ–‡æ¡£ï¼ˆ2å‘¨ï¼‰

- [ ] ç¼–å†™å•å…ƒæµ‹è¯•
- [ ] ç¼–å†™é›†æˆæµ‹è¯•
- [ ] ç¼–å†™ E2E æµ‹è¯•
- [ ] æ›´æ–°æ–‡æ¡£

---

## ğŸ”— å‚è€ƒèµ„æº

- [Clean Architecture](https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html)
- [Ent Documentation](https://entgo.io/)
- [Wire Documentation](https://github.com/google/wire)
- [OpenTelemetry Go](https://opentelemetry.io/docs/instrumentation/go/)
- [Chi Router](https://github.com/go-chi/chi)
- [Echo Framework](https://echo.labstack.com/)

---

**åˆ›å»ºæ—¥æœŸ**: 2025-11-11
**çŠ¶æ€**: å¾…æ‰§è¡Œ
