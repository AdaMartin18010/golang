# PowerShell Script: åˆ›å»ºæ–°çš„æ–‡æ¡£ç›®å½•ç»“æ„
# ç”¨é€”: è‡ªåŠ¨åˆ›å»ºé‡æ„åçš„13ä¸ªä¸»é¢˜æ¨¡å—ç›®å½•
# ç‰ˆæœ¬: v1.0
# æ—¥æœŸ: 2025-10-22

param(
    [string]$BaseDir = "docs-new",
    [switch]$DryRun
)

Write-Host "========================================" -ForegroundColor Cyan
Write-Host "  Golang æ–‡æ¡£ç»“æ„åˆ›å»ºè„šæœ¬" -ForegroundColor Cyan
Write-Host "  ç‰ˆæœ¬: v1.0" -ForegroundColor Cyan
Write-Host "========================================" -ForegroundColor Cyan
Write-Host ""

if ($DryRun) {
    Write-Host "[DRY RUN æ¨¡å¼] ä»…æ˜¾ç¤ºå°†è¦åˆ›å»ºçš„ç›®å½•" -ForegroundColor Yellow
    Write-Host ""
}

# å®šä¹‰æ–°ç»“æ„
$structure = @(
    # 01-è¯­è¨€åŸºç¡€
    "01-è¯­è¨€åŸºç¡€/01-è¯­æ³•åŸºç¡€",
    "01-è¯­è¨€åŸºç¡€/02-å¹¶å‘ç¼–ç¨‹",
    "01-è¯­è¨€åŸºç¡€/03-æ¨¡å—ç®¡ç†",
    "01-è¯­è¨€åŸºç¡€/04-æ ‡å‡†åº“ç²¾è®²",
    
    # 02-æ•°æ®ç»“æ„ä¸ç®—æ³•
    "02-æ•°æ®ç»“æ„ä¸ç®—æ³•/01-åŸºç¡€æ•°æ®ç»“æ„",
    "02-æ•°æ®ç»“æ„ä¸ç®—æ³•/02-ç®—æ³•å®ç°",
    "02-æ•°æ®ç»“æ„ä¸ç®—æ³•/03-Goç‰¹æœ‰å®ç°",
    
    # 03-Webå¼€å‘
    "03-Webå¼€å‘/01-HTTPç¼–ç¨‹",
    "03-Webå¼€å‘/02-Webæ¡†æ¶",
    "03-Webå¼€å‘/03-Webè¿›é˜¶",
    "03-Webå¼€å‘/04-RESTful-API",
    "03-Webå¼€å‘/05-è®¤è¯ä¸æˆæƒ",
    "03-Webå¼€å‘/06-å®‰å…¨ä¸æ€§èƒ½",
    
    # 04-æ•°æ®åº“ç¼–ç¨‹
    "04-æ•°æ®åº“ç¼–ç¨‹/01-SQLæ•°æ®åº“",
    "04-æ•°æ®åº“ç¼–ç¨‹/02-NoSQLæ•°æ®åº“",
    "04-æ•°æ®åº“ç¼–ç¨‹/03-ORMæ¡†æ¶",
    "04-æ•°æ®åº“ç¼–ç¨‹/04-æ•°æ®åº“é«˜çº§",
    
    # 05-å¾®æœåŠ¡æ¶æ„
    "05-å¾®æœåŠ¡æ¶æ„/01-å¾®æœåŠ¡åŸºç¡€",
    "05-å¾®æœåŠ¡æ¶æ„/02-RPCæ¡†æ¶",
    "05-å¾®æœåŠ¡æ¶æ„/03-æœåŠ¡å‘ç°",
    "05-å¾®æœåŠ¡æ¶æ„/04-APIç½‘å…³",
    "05-å¾®æœåŠ¡æ¶æ„/05-æœåŠ¡ç½‘æ ¼",
    "05-å¾®æœåŠ¡æ¶æ„/06-æ¶ˆæ¯é˜Ÿåˆ—",
    "05-å¾®æœåŠ¡æ¶æ„/07-å¾®æœåŠ¡é«˜çº§",
    
    # 06-äº‘åŸç”Ÿ
    "06-äº‘åŸç”Ÿ/01-å®¹å™¨åŒ–",
    "06-äº‘åŸç”Ÿ/02-Kubernetes",
    "06-äº‘åŸç”Ÿ/03-Service-Mesh",
    "06-äº‘åŸç”Ÿ/04-äº‘åŸç”Ÿç”Ÿæ€",
    
    # 07-æ€§èƒ½ä¼˜åŒ–
    "07-æ€§èƒ½ä¼˜åŒ–/01-æ€§èƒ½åˆ†æ",
    "07-æ€§èƒ½ä¼˜åŒ–/02-å†…å­˜ä¼˜åŒ–",
    "07-æ€§èƒ½ä¼˜åŒ–/03-å¹¶å‘ä¼˜åŒ–",
    "07-æ€§èƒ½ä¼˜åŒ–/04-å…¶ä»–ä¼˜åŒ–",
    "07-æ€§èƒ½ä¼˜åŒ–/05-å¸¸è§é—®é¢˜",
    
    # 08-æ¶æ„è®¾è®¡
    "08-æ¶æ„è®¾è®¡/01-è®¾è®¡æ¨¡å¼",
    "08-æ¶æ„è®¾è®¡/02-æ¶æ„æ¨¡å¼",
    "08-æ¶æ„è®¾è®¡/03-é¢†åŸŸé©±åŠ¨è®¾è®¡",
    "08-æ¶æ„è®¾è®¡/04-æ¶æ„å®æˆ˜",
    
    # 09-å·¥ç¨‹å®è·µ
    "09-å·¥ç¨‹å®è·µ/01-æµ‹è¯•",
    "09-å·¥ç¨‹å®è·µ/02-ä»£ç è´¨é‡",
    "09-å·¥ç¨‹å®è·µ/03-CI-CD",
    "09-å·¥ç¨‹å®è·µ/04-ç›‘æ§ä¸å¯è§‚æµ‹æ€§",
    "09-å·¥ç¨‹å®è·µ/05-æ–‡æ¡£ä¸è§„èŒƒ",
    
    # 10-Goç‰ˆæœ¬ç‰¹æ€§
    "10-Goç‰ˆæœ¬ç‰¹æ€§/01-Go-1.21ç‰¹æ€§",
    "10-Goç‰ˆæœ¬ç‰¹æ€§/02-Go-1.22ç‰¹æ€§",
    "10-Goç‰ˆæœ¬ç‰¹æ€§/03-Go-1.23ç‰¹æ€§",
    "10-Goç‰ˆæœ¬ç‰¹æ€§/04-Go-1.24ç‰¹æ€§",
    "10-Goç‰ˆæœ¬ç‰¹æ€§/05-Go-1.25ç‰¹æ€§",
    "10-Goç‰ˆæœ¬ç‰¹æ€§/06-å®éªŒæ€§ç‰¹æ€§",
    "10-Goç‰ˆæœ¬ç‰¹æ€§/07-ç‰ˆæœ¬è¿ç§»æŒ‡å—",
    
    # 11-é«˜çº§ä¸“é¢˜
    "11-é«˜çº§ä¸“é¢˜/01-åº•å±‚åŸç†",
    "11-é«˜çº§ä¸“é¢˜/02-æ±‡ç¼–ä¸CGO",
    "11-é«˜çº§ä¸“é¢˜/03-å®‰å…¨",
    "11-é«˜çº§ä¸“é¢˜/04-åˆ†å¸ƒå¼ç³»ç»Ÿ",
    "11-é«˜çº§ä¸“é¢˜/05-WebAssembly",
    "11-é«˜çº§ä¸“é¢˜/06-æ–°å…´æŠ€æœ¯",
    
    # 12-è¡Œä¸šåº”ç”¨
    "12-è¡Œä¸šåº”ç”¨/01-é‡‘èç§‘æŠ€",
    "12-è¡Œä¸šåº”ç”¨/02-æ¸¸æˆå¼€å‘",
    "12-è¡Œä¸šåº”ç”¨/03-ç‰©è”ç½‘",
    "12-è¡Œä¸šåº”ç”¨/04-äººå·¥æ™ºèƒ½",
    "12-è¡Œä¸šåº”ç”¨/05-å¤§æ•°æ®",
    "12-è¡Œä¸šåº”ç”¨/06-ç”µå•†ç³»ç»Ÿ",
    "12-è¡Œä¸šåº”ç”¨/07-å…¶ä»–è¡Œä¸š",
    
    # 13-å‚è€ƒèµ„æ–™
    "13-å‚è€ƒèµ„æ–™"
)

$createdCount = 0
$totalCount = $structure.Count

# READMEæ¨¡æ¿
$readmeTemplate = @"
# {0}

> ğŸ“š **ç®€ä»‹**: æœ¬æ¨¡å—æ–‡æ¡£å¾…è¡¥å……

## ğŸ“‹ å†…å®¹åˆ—è¡¨

å¾…æ·»åŠ ...

## ğŸ¯ å­¦ä¹ ç›®æ ‡

- ç›®æ ‡1
- ç›®æ ‡2
- ç›®æ ‡3

## ğŸ“š å‚è€ƒèµ„æ–™

å¾…æ·»åŠ ...

---

**ç»´æŠ¤è€…**: Documentation Team  
**æœ€åæ›´æ–°**: 2025å¹´10æœˆ22æ—¥  
**çŠ¶æ€**: å¾…å®Œå–„
"@

# åˆ›å»ºç›®å½•
foreach ($dir in $structure) {
    $fullPath = Join-Path $BaseDir $dir
    
    if ($DryRun) {
        Write-Host "[DRY RUN] å°†åˆ›å»º: $fullPath" -ForegroundColor Yellow
    } else {
        # åˆ›å»ºç›®å½•
        if (!(Test-Path $fullPath)) {
            New-Item -ItemType Directory -Path $fullPath -Force | Out-Null
            Write-Host "âœ… å·²åˆ›å»º: $fullPath" -ForegroundColor Green
            $createdCount++
        } else {
            Write-Host "â­ï¸  å·²å­˜åœ¨: $fullPath" -ForegroundColor Gray
        }
        
        # åˆ›å»ºREADME.md
        $readmePath = Join-Path $fullPath "README.md"
        if (!(Test-Path $readmePath)) {
            $dirName = Split-Path $dir -Leaf
            $readmeContent = $readmeTemplate -f $dirName
            $readmeContent | Out-File -FilePath $readmePath -Encoding UTF8
            Write-Host "   ğŸ“„ å·²åˆ›å»ºREADME: $readmePath" -ForegroundColor Cyan
        }
    }
}

Write-Host ""
Write-Host "========================================" -ForegroundColor Cyan

if ($DryRun) {
    Write-Host "âœ… DRY RUN å®Œæˆ! å…± $totalCount ä¸ªç›®å½•å¾…åˆ›å»º" -ForegroundColor Yellow
} else {
    Write-Host "âœ… ç»“æ„åˆ›å»ºå®Œæˆ!" -ForegroundColor Green
    Write-Host "   æ–°åˆ›å»º: $createdCount ä¸ªç›®å½•" -ForegroundColor Green
    Write-Host "   æ€»ç›®å½•: $totalCount ä¸ª" -ForegroundColor Cyan
}

Write-Host "========================================" -ForegroundColor Cyan
Write-Host ""
Write-Host "ğŸ“ ä¸‹ä¸€æ­¥æ“ä½œ:" -ForegroundColor Yellow
Write-Host "   1. è¿è¡Œ migrate_documents.ps1 è¿ç§»æ–‡æ¡£" -ForegroundColor White
Write-Host "   2. è¿è¡Œ fix_links.ps1 ä¿®å¤é“¾æ¥" -ForegroundColor White
Write-Host "   3. è¿è¡Œ check_quality.ps1 è´¨é‡æ£€æŸ¥" -ForegroundColor White
Write-Host ""

