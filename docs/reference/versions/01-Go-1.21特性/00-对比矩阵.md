# Go 1.21特性 - 对比矩阵

**版本**: v1.0  
**发布日期**: 2023年8月  
**更新日期**: 2025-10-28

---

## 1. Go 1.21 vs Go 1.20

| 维度 | Go 1.20 | Go 1.21 | 提升 |
|------|---------|---------|------|
| **内置函数** | 15个 | 17个(+min/max/clear) | +13% |
| **PGO支持** | ❌ | ✅ | 性能+2-14% |
| **结构化日志** | ❌ | ✅ (log/slog) | 新增 |
| **切片操作** | 手动实现 | slices包 | 易用性⬆ |
| **映射操作** | 手动实现 | maps包 | 易用性⬆ |
| **编译速度** | 基准 | +10% | ⭐⭐⭐⭐ |

---

## 2. 新特性对比

### 内置函数对比

| 函数 | Go 1.20 | Go 1.21 | 使用便利性 |
|------|---------|---------|-----------|
| **min** | 手动实现 | 内置 | ⭐⭐⭐⭐⭐ |
| **max** | 手动实现 | 内置 | ⭐⭐⭐⭐⭐ |
| **clear** | 手动循环 | 内置 | ⭐⭐⭐⭐⭐ |

**Before (Go 1.20)**:
```go
// 需要手动实现
func min(a, b int) int {
    if a < b {
        return a
    }
    return b
}
```

**After (Go 1.21)**:
```go
// 内置函数
result := min(1, 2, 3)  // 简洁！
```

---

## 3. PGO性能对比

| 场景 | 无PGO | 有PGO | 提升 |
|------|-------|-------|------|
| **Web服务** | 基准 | +3-7% | ⭐⭐⭐⭐ |
| **编译器** | 基准 | +2-4% | ⭐⭐⭐ |
| **数据处理** | 基准 | +5-14% | ⭐⭐⭐⭐⭐ |
| **CPU密集** | 基准 | +8-14% | ⭐⭐⭐⭐⭐ |

---

## 4. 标准库对比

### log包对比

| 特性 | log包 | log/slog包 | 优势 |
|------|-------|-----------|------|
| **结构化** | ❌ | ✅ | ⭐⭐⭐⭐⭐ |
| **性能** | 基准 | 更快 | ⭐⭐⭐⭐ |
| **灵活性** | 低 | 高 | ⭐⭐⭐⭐⭐ |
| **JSON输出** | 手动 | 内置 | ⭐⭐⭐⭐⭐ |

---

## 5. 升级建议

### 推荐升级场景

| 场景 | 优先级 | 收益 | 难度 |
|------|-------|------|------|
| **使用泛型项目** | ⭐⭐⭐⭐⭐ | 编译速度⬆ | 低 |
| **高性能服务** | ⭐⭐⭐⭐⭐ | PGO性能⬆ | 低 |
| **需要结构化日志** | ⭐⭐⭐⭐⭐ | log/slog | 低 |
| **大量切片/映射操作** | ⭐⭐⭐⭐ | slices/maps | 低 |

### 兼容性

| 维度 | 兼容性 | 说明 |
|------|-------|------|
| **API兼容** | ✅ 100% | 向后兼容 |
| **行为变化** | ⚠️ 极少 | GODEBUG可控 |
| **升级难度** | ⭐ | 非常简单 |

---

## 🔗 相关文档

- [知识图谱](./00-知识图谱.md)
- [概念定义体系](./00-概念定义体系.md)
- [README.md](./README.md)

---

**最后更新**: 2025-10-28
