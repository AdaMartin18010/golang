# 常见问题

**版本**: v1.0  
**更新日期**: 2025-10-29  
**适用于**: Go 1.25.3

---

## 📋 目录

- [1. 📖 语言相关](#1-语言相关)
  - [Q: 为什么没有泛型？](#q-为什么没有泛型)
  - [Q: 如何处理nil指针？](#q-如何处理nil指针)
  - [Q: slice和array区别？](#q-slice和array区别)
- [🔧 并发相关](#并发相关)
  - [Q: goroutine泄漏？](#q-goroutine泄漏)
  - [Q: channel什么时候关闭？](#q-channel什么时候关闭)
- [🌐 Web开发](#web开发)
  - [Q: 如何处理CORS？](#q-如何处理cors)
  - [Q: 如何实现优雅关闭？](#q-如何实现优雅关闭)
- [🐛 调试相关](#调试相关)
  - [Q: 如何调试？](#q-如何调试)
  - [Q: 如何性能分析？](#q-如何性能分析)
- [🗄️ 性能相关](#性能相关)
  - [Q: 如何优化内存使用？](#q-如何优化内存使用)
  - [Q: 什么是内存逃逸？](#q-什么是内存逃逸)
- [🔌 模块相关](#模块相关)
  - [Q: go.mod和go.sum的作用？](#q-go-mod和go-sum的作用)
  - [Q: 如何使用私有仓库？](#q-如何使用私有仓库)
- [📚 相关资源](#相关资源)

## 1. 📖 语言相关

### Q: 为什么没有泛型？

**A**: Go 1.18+已支持泛型。

```go
func Max[T constraints.Ordered](a, b T) T {
    if a > b {
        return a
    }
    return b
}
```

---

### Q: 如何处理nil指针？

**A**: 始终检查nil。

```go
if ptr != nil {
    value := *ptr
}
```

---

### Q: slice和array区别？

**A**:

- array: 固定长度
- slice: 动态长度，底层指向array

```go
arr := [3]int{1, 2, 3}  // array
slice := []int{1, 2, 3}  // slice
```

---

## 🔧 并发相关

### Q: goroutine泄漏？

**A**: 确保goroutine能正常退出。

```go
ctx, cancel := context.WithCancel(context.Background())
defer cancel()

go func() {
    for {
        select {
        case <-ctx.Done():
            return
        default:
            // work...
        }
    }
}()
```

---

### Q: channel什么时候关闭？

**A**:

- 只在发送端关闭
- 接收端通过ok判断

```go
ch := make(chan int)
go func() {
    ch <- 42
    close(ch)
}()

v, ok := <-ch
if !ok {
    // channel已关闭
}
```

---

## 🌐 Web开发

### Q: 如何处理CORS？

**A**: 设置响应头或使用中间件。

```go
w.Header().Set("Access-Control-Allow-Origin", "*")
```

---

### Q: 如何实现优雅关闭？

**A**: 监听信号并超时关闭。

```go
quit := make(chan os.Signal, 1)
signal.Notify(quit, syscall.SIGTERM)
<-quit

ctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)
defer cancel()
server.Shutdown(ctx)
```

---

## 🐛 调试相关

### Q: 如何调试？

**A**:

- 使用`fmt.Printf`
- 使用Delve调试器
- 使用IDE断点

---

### Q: 如何性能分析？

**A**:

```go
import _ "net/http/pprof"

http.ListenAndServe(":6060", nil)
```

```bash
go tool pprof http://localhost:6060/debug/pprof/profile
```

---

## 🗄️ 性能相关

### Q: 如何优化内存使用？

**A**:

- 复用对象：使用sync.Pool
- 避免内存逃逸
- 预分配slice容量

```go
// sync.Pool
var bufPool = sync.Pool{
    New: func() interface{} {
        return new(bytes.Buffer)
    },
}

// 预分配
slice := make([]int, 0, 100)
```

---

### Q: 什么是内存逃逸？

**A**: 变量从栈逃逸到堆。

```bash
# 查看逃逸分析
go build -gcflags="-m" main.go
```

---

## 🔌 模块相关

### Q: go.mod和go.sum的作用？

**A**:

- `go.mod`: 依赖声明
- `go.sum`: 依赖校验

```bash
go mod init myproject
go mod tidy  # 清理依赖
go mod vendor  # 导出到vendor
```

---

### Q: 如何使用私有仓库？

**A**:

```bash
export GOPRIVATE=github.com/mycompany/*
git config --global url."git@github.com:".insteadOf "https://github.com/"
```

---

## 📚 相关资源

- [Go FAQ](https://go.dev/doc/faq)
- [学习路线图](./01-学习路线图.md)
- [资源汇总](./02-资源汇总.md)

---
