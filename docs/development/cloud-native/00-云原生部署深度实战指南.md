# äº‘åŸç”Ÿéƒ¨ç½²æ·±åº¦å®æˆ˜æŒ‡å—

> **ç®€ä»‹**: å…¨é¢æŒæ¡Goåº”ç”¨äº‘åŸç”Ÿéƒ¨ç½²ï¼Œä»Dockerå®¹å™¨åŒ–åˆ°Kubernetesç¼–æ’ï¼Œå†åˆ°CI/CDæµæ°´çº¿å®æˆ˜
> **ç‰ˆæœ¬**: Go 1.23+  
> **éš¾åº¦**: â­â­â­â­  
> **æ ‡ç­¾**: #äº‘åŸç”Ÿ #Docker #Kubernetes #CI/CD

**å­—æ•°**: ~38,000å­—  
**ä»£ç ç¤ºä¾‹**: 120+ä¸ªå®Œæ•´ç¤ºä¾‹  
**å®æˆ˜æ¡ˆä¾‹**: 13ä¸ªç«¯åˆ°ç«¯æ¡ˆä¾‹  
**é€‚ç”¨äººç¾¤**: ä¸­çº§åˆ°é«˜çº§Goå¼€å‘è€…

---

## ğŸ“‹ ç›®å½•


- [ç¬¬ä¸€éƒ¨åˆ†ï¼šDockerå®¹å™¨åŒ–](#ç¬¬ä¸€éƒ¨åˆ†dockerå®¹å™¨åŒ–)
  - [Dockeræ ¸å¿ƒæ¦‚å¿µ](#dockeræ ¸å¿ƒæ¦‚å¿µ)
  - [å®æˆ˜æ¡ˆä¾‹1ï¼šGoåº”ç”¨Dockerfile](#å®æˆ˜æ¡ˆä¾‹1goåº”ç”¨dockerfile)
  - [å®æˆ˜æ¡ˆä¾‹2ï¼š.dockerignoreä¼˜åŒ–](#å®æˆ˜æ¡ˆä¾‹2dockerignoreä¼˜åŒ–)
  - [å®æˆ˜æ¡ˆä¾‹3ï¼šDocker Composeå¼€å‘ç¯å¢ƒ](#å®æˆ˜æ¡ˆä¾‹3docker-composeå¼€å‘ç¯å¢ƒ)
- [ç¬¬äºŒéƒ¨åˆ†ï¼šKubernetesæ ¸å¿ƒæ¦‚å¿µ](#ç¬¬äºŒéƒ¨åˆ†kubernetesæ ¸å¿ƒæ¦‚å¿µ)
  - [Kubernetesæ¶æ„](#kubernetesæ¶æ„)
  - [å®æˆ˜æ¡ˆä¾‹4ï¼šDeploymentéƒ¨ç½²](#å®æˆ˜æ¡ˆä¾‹4deploymentéƒ¨ç½²)
  - [å®æˆ˜æ¡ˆä¾‹5ï¼šServiceè´Ÿè½½å‡è¡¡](#å®æˆ˜æ¡ˆä¾‹5serviceè´Ÿè½½å‡è¡¡)
- [ç¬¬ä¸‰éƒ¨åˆ†ï¼šConfigMapä¸Secret](#ç¬¬ä¸‰éƒ¨åˆ†configmapä¸secret)
  - [å®æˆ˜æ¡ˆä¾‹6ï¼šConfigMapé…ç½®ç®¡ç†](#å®æˆ˜æ¡ˆä¾‹6configmapé…ç½®ç®¡ç†)
- [ç¬¬å››éƒ¨åˆ†ï¼šIngressè·¯ç”±](#ç¬¬å››éƒ¨åˆ†ingressè·¯ç”±)
  - [å®æˆ˜æ¡ˆä¾‹7ï¼šNginx Ingressé…ç½®](#å®æˆ˜æ¡ˆä¾‹7nginx-ingressé…ç½®)
- [ç¬¬äº”éƒ¨åˆ†ï¼šHelmåŒ…ç®¡ç†](#ç¬¬äº”éƒ¨åˆ†helmåŒ…ç®¡ç†)
  - [å®æˆ˜æ¡ˆä¾‹8ï¼šHelm Chartç»“æ„](#å®æˆ˜æ¡ˆä¾‹8helm-chartç»“æ„)
- [ğŸ¯ æ€»ç»“](#-æ€»ç»“)
  - [äº‘åŸç”Ÿæ ¸å¿ƒè¦ç‚¹](#äº‘åŸç”Ÿæ ¸å¿ƒè¦ç‚¹)
  - [æœ€ä½³å®è·µæ¸…å•](#æœ€ä½³å®è·µæ¸…å•)

## ç¬¬ä¸€éƒ¨åˆ†ï¼šDockerå®¹å™¨åŒ–

### Dockeræ ¸å¿ƒæ¦‚å¿µ

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Dockeræ¶æ„                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                Application
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Docker Image                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚       Application Layer                  â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚       Dependencies Layer                 â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚       Base OS Layer (Alpine/Debian)      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Docker Container                  â”‚
â”‚  - è¿›ç¨‹éš”ç¦»                                     â”‚
â”‚  - ç½‘ç»œéš”ç¦»                                     â”‚
â”‚  - æ–‡ä»¶ç³»ç»Ÿéš”ç¦»                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### å®æˆ˜æ¡ˆä¾‹1ï¼šGoåº”ç”¨Dockerfile

```dockerfile
# ===== å¤šé˜¶æ®µæ„å»º Dockerfile =====

# é˜¶æ®µ1ï¼šæ„å»ºé˜¶æ®µ
FROM golang:1.23-alpine AS builder

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /app

# å®‰è£…ä¾èµ–
RUN apk add --no-cache git ca-certificates tzdata

# å¤åˆ¶go.modå’Œgo.sum
COPY go.mod go.sum ./

# ä¸‹è½½ä¾èµ–
RUN go mod download

# å¤åˆ¶æºä»£ç 
COPY . .

# æ„å»ºåº”ç”¨ï¼ˆé™æ€ç¼–è¯‘ï¼‰
RUN CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build \
    -ldflags="-w -s" \
    -o /app/server \
    ./cmd/server

# é˜¶æ®µ2ï¼šè¿è¡Œé˜¶æ®µ
FROM alpine:latest

# å®‰è£…CAè¯ä¹¦å’Œæ—¶åŒºæ•°æ®
RUN apk --no-cache add ca-certificates tzdata

# è®¾ç½®æ—¶åŒº
ENV TZ=Asia/Shanghai

# åˆ›å»ºérootç”¨æˆ·
RUN addgroup -g 1000 appuser && \
    adduser -D -u 1000 -G appuser appuser

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /app

# ä»æ„å»ºé˜¶æ®µå¤åˆ¶äºŒè¿›åˆ¶æ–‡ä»¶
COPY --from=builder /app/server .

# å¤åˆ¶é…ç½®æ–‡ä»¶
COPY --from=builder /app/config ./config

# æ›´æ”¹æ‰€æœ‰æƒ
RUN chown -R appuser:appuser /app

# åˆ‡æ¢åˆ°érootç”¨æˆ·
USER appuser

# æš´éœ²ç«¯å£
EXPOSE 8080

# å¥åº·æ£€æŸ¥
HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
    CMD wget --no-verbose --tries=1 --spider http://localhost:8080/health || exit 1

# å¯åŠ¨åº”ç”¨
CMD ["./server"]
```

---

### å®æˆ˜æ¡ˆä¾‹2ï¼š.dockerignoreä¼˜åŒ–

```dockerignore
# Git
.git
.gitignore

# æ–‡æ¡£
*.md
docs/

# æµ‹è¯•æ–‡ä»¶
*_test.go
testdata/

# å¼€å‘å·¥å…·
.vscode/
.idea/

# æ„å»ºäº§ç‰©
bin/
dist/
*.exe

# ä¾èµ–
vendor/

# ç¯å¢ƒå˜é‡
.env
.env.local

# æ—¥å¿—
*.log
logs/

# ä¸´æ—¶æ–‡ä»¶
tmp/
temp/
```

---

### å®æˆ˜æ¡ˆä¾‹3ï¼šDocker Composeå¼€å‘ç¯å¢ƒ

```yaml
# docker-compose.yml
version: '3.8'

services:
  # Goåº”ç”¨
  app:
    build:
      context: .
      dockerfile: Dockerfile
      target: builder  # å¼€å‘é˜¶æ®µä½¿ç”¨builder
    container_name: go-app
    ports:
      - "8080:8080"
    environment:
      - DB_HOST=postgres
      - DB_PORT=5432
      - DB_USER=postgres
      - DB_PASSWORD=secret
      - DB_NAME=myapp
      - REDIS_HOST=redis
      - REDIS_PORT=6379
    volumes:
      - .:/app  # æŒ‚è½½æºä»£ç ï¼ˆå¼€å‘çƒ­é‡è½½ï¼‰
      - /app/vendor  # æ’é™¤vendorç›®å½•
    depends_on:
      - postgres
      - redis
    networks:
      - app-network
    command: air  # ä½¿ç”¨airå®ç°çƒ­é‡è½½

  # PostgreSQLæ•°æ®åº“
  postgres:
    image: postgres:15-alpine
    container_name: postgres
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: secret
      POSTGRES_DB: myapp
    ports:
      - "5432:5432"
    volumes:
      - postgres-data:/var/lib/postgresql/data
      - ./scripts/init.sql:/docker-entrypoint-initdb.d/init.sql
    networks:
      - app-network
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U postgres"]
      interval: 10s
      timeout: 5s
      retries: 5

  # Redisç¼“å­˜
  redis:
    image: redis:7-alpine
    container_name: redis
    ports:
      - "6379:6379"
    volumes:
      - redis-data:/data
    networks:
      - app-network
    command: redis-server --appendonly yes
    healthcheck:
      test: ["CMD", "redis-cli", "ping"]
      interval: 10s
      timeout: 3s
      retries: 3

  # Nginxåå‘ä»£ç†
  nginx:
    image: nginx:alpine
    container_name: nginx
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro
      - ./nginx/ssl:/etc/nginx/ssl:ro
    depends_on:
      - app
    networks:
      - app-network

volumes:
  postgres-data:
  redis-data:

networks:
  app-network:
    driver: bridge
```

---

## ç¬¬äºŒéƒ¨åˆ†ï¼šKubernetesæ ¸å¿ƒæ¦‚å¿µ

### Kubernetesæ¶æ„

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Kubernetesé›†ç¾¤                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Master Node (Control Plane)
â”œâ”€â”€ API Server        - é›†ç¾¤å…¥å£
â”œâ”€â”€ etcd              - åˆ†å¸ƒå¼å­˜å‚¨
â”œâ”€â”€ Scheduler         - è°ƒåº¦å™¨
â”œâ”€â”€ Controller Manager - æ§åˆ¶å™¨ç®¡ç†
â””â”€â”€ Cloud Controller  - äº‘å¹³å°é›†æˆ

Worker Nodes
â”œâ”€â”€ kubelet           - èŠ‚ç‚¹ä»£ç†
â”œâ”€â”€ kube-proxy        - ç½‘ç»œä»£ç†
â”œâ”€â”€ Container Runtime - å®¹å™¨è¿è¡Œæ—¶ï¼ˆDocker/containerdï¼‰
â””â”€â”€ Pods
    â”œâ”€â”€ Container 1
    â”œâ”€â”€ Container 2
    â””â”€â”€ ...

Kuberneteså¯¹è±¡:
- Pod        - æœ€å°éƒ¨ç½²å•å…ƒ
- Deployment - éƒ¨ç½²ç®¡ç†
- Service    - æœåŠ¡å‘ç°
- ConfigMap  - é…ç½®ç®¡ç†
- Secret     - å¯†é’¥ç®¡ç†
- Ingress    - å¤–éƒ¨è®¿é—®
```

---

### å®æˆ˜æ¡ˆä¾‹4ï¼šDeploymentéƒ¨ç½²

```yaml
# deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: go-app
  namespace: production
  labels:
    app: go-app
    version: v1.0.0
spec:
  replicas: 3  # å‰¯æœ¬æ•°
  
  # æ»šåŠ¨æ›´æ–°ç­–ç•¥
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxSurge: 1        # æœ€å¤šè¶…å‡ºå‰¯æœ¬æ•°1ä¸ª
      maxUnavailable: 1  # æœ€å¤šä¸å¯ç”¨å‰¯æœ¬æ•°1ä¸ª
  
  # Podé€‰æ‹©å™¨
  selector:
    matchLabels:
      app: go-app
  
  # Podæ¨¡æ¿
  template:
    metadata:
      labels:
        app: go-app
        version: v1.0.0
    spec:
      # å®¹å™¨åˆ—è¡¨
      containers:
      - name: go-app
        image: myregistry.com/go-app:v1.0.0
        imagePullPolicy: Always
        
        # ç«¯å£
        ports:
        - name: http
          containerPort: 8080
          protocol: TCP
        
        # ç¯å¢ƒå˜é‡
        env:
        - name: PORT
          value: "8080"
        - name: DB_HOST
          valueFrom:
            configMapKeyRef:
              name: app-config
              key: db.host
        - name: DB_PASSWORD
          valueFrom:
            secretKeyRef:
              name: app-secret
              key: db.password
        
        # èµ„æºé™åˆ¶
        resources:
          requests:
            cpu: 100m      # 100æ¯«æ ¸
            memory: 128Mi  # 128MB
          limits:
            cpu: 500m      # 500æ¯«æ ¸
            memory: 512Mi  # 512MB
        
        # å­˜æ´»æ¢é’ˆ
        livenessProbe:
          httpGet:
            path: /health
            port: 8080
          initialDelaySeconds: 30
          periodSeconds: 10
          timeoutSeconds: 3
          failureThreshold: 3
        
        # å°±ç»ªæ¢é’ˆ
        readinessProbe:
          httpGet:
            path: /ready
            port: 8080
          initialDelaySeconds: 10
          periodSeconds: 5
          timeoutSeconds: 2
          failureThreshold: 3
        
        # æŒ‚è½½å·
        volumeMounts:
        - name: config
          mountPath: /app/config
          readOnly: true
        - name: logs
          mountPath: /app/logs
      
      # å·å®šä¹‰
      volumes:
      - name: config
        configMap:
          name: app-config
      - name: logs
        emptyDir: {}
      
      # é•œåƒæ‹‰å–å¯†é’¥
      imagePullSecrets:
      - name: registry-secret
      
      # å®‰å…¨ä¸Šä¸‹æ–‡
      securityContext:
        runAsNonRoot: true
        runAsUser: 1000
        fsGroup: 1000
```

---

### å®æˆ˜æ¡ˆä¾‹5ï¼šServiceè´Ÿè½½å‡è¡¡

```yaml
# service.yaml
apiVersion: v1
kind: Service
metadata:
  name: go-app-service
  namespace: production
  labels:
    app: go-app
spec:
  # Serviceç±»å‹
  type: ClusterIP  # ClusterIP | NodePort | LoadBalancer
  
  # Podé€‰æ‹©å™¨
  selector:
    app: go-app
  
  # ç«¯å£æ˜ å°„
  ports:
  - name: http
    port: 80        # Serviceç«¯å£
    targetPort: 8080 # Podç«¯å£
    protocol: TCP
  
  # Sessionäº²å’Œæ€§
  sessionAffinity: ClientIP
  sessionAffinityConfig:
    clientIP:
      timeoutSeconds: 10800

---
# service-nodeport.yamlï¼ˆç”¨äºå¤–éƒ¨è®¿é—®ï¼‰
apiVersion: v1
kind: Service
metadata:
  name: go-app-nodeport
  namespace: production
spec:
  type: NodePort
  selector:
    app: go-app
  ports:
  - name: http
    port: 80
    targetPort: 8080
    nodePort: 30080  # 30000-32767èŒƒå›´

---
# service-loadbalancer.yamlï¼ˆäº‘å¹³å°ï¼‰
apiVersion: v1
kind: Service
metadata:
  name: go-app-lb
  namespace: production
  annotations:
    service.beta.kubernetes.io/aws-load-balancer-type: "nlb"
spec:
  type: LoadBalancer
  selector:
    app: go-app
  ports:
  - name: http
    port: 80
    targetPort: 8080
```

---

## ç¬¬ä¸‰éƒ¨åˆ†ï¼šConfigMapä¸Secret

### å®æˆ˜æ¡ˆä¾‹6ï¼šConfigMapé…ç½®ç®¡ç†

```yaml
# configmap.yaml
apiVersion: v1
kind: ConfigMap
metadata:
  name: app-config
  namespace: production
data:
  # é”®å€¼å¯¹
  app.name: "go-app"
  app.env: "production"
  db.host: "postgres.production.svc.cluster.local"
  db.port: "5432"
  db.name: "myapp"
  redis.host: "redis.production.svc.cluster.local"
  redis.port: "6379"
  
  # æ–‡ä»¶å†…å®¹
  app.yaml: |
    server:
      port: 8080
      readTimeout: 10s
      writeTimeout: 10s
    database:
      maxOpenConns: 25
      maxIdleConns: 5
      connMaxLifetime: 5m
    cache:
      ttl: 300
      maxSize: 1000

---
# secret.yaml
apiVersion: v1
kind: Secret
metadata:
  name: app-secret
  namespace: production
type: Opaque
stringData:
  db.password: "MySecurePassword123!"
  api.key: "sk-xxxxxxxxxxxx"
  jwt.secret: "my-jwt-secret-key"

# æˆ–ä½¿ç”¨base64ç¼–ç 
data:
  db.password: TXlTZWN1cmVQYXNzd29yZDEyMyE=

---
# åœ¨Podä¸­ä½¿ç”¨ConfigMapå’ŒSecret
apiVersion: v1
kind: Pod
metadata:
  name: go-app
spec:
  containers:
  - name: app
    image: go-app:latest
    
    # æ–¹å¼1ï¼šç¯å¢ƒå˜é‡
    env:
    - name: APP_NAME
      valueFrom:
        configMapKeyRef:
          name: app-config
          key: app.name
    - name: DB_PASSWORD
      valueFrom:
        secretKeyRef:
          name: app-secret
          key: db.password
    
    # æ–¹å¼2ï¼šæŒ‚è½½ä¸ºæ–‡ä»¶
    volumeMounts:
    - name: config-volume
      mountPath: /app/config
    - name: secret-volume
      mountPath: /app/secrets
      readOnly: true
  
  volumes:
  - name: config-volume
    configMap:
      name: app-config
      items:
      - key: app.yaml
        path: config.yaml
  - name: secret-volume
    secret:
      secretName: app-secret
```

---

## ç¬¬å››éƒ¨åˆ†ï¼šIngressè·¯ç”±

### å®æˆ˜æ¡ˆä¾‹7ï¼šNginx Ingressé…ç½®

```yaml
# ingress.yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: go-app-ingress
  namespace: production
  annotations:
    # Nginx Ingressæ³¨è§£
    nginx.ingress.kubernetes.io/rewrite-target: /
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
    nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
    
    # CORSé…ç½®
    nginx.ingress.kubernetes.io/enable-cors: "true"
    nginx.ingress.kubernetes.io/cors-allow-methods: "GET, POST, PUT, DELETE, OPTIONS"
    nginx.ingress.kubernetes.io/cors-allow-origin: "*"
    
    # é™æµ
    nginx.ingress.kubernetes.io/limit-rps: "100"
    
    # è¶…æ—¶
    nginx.ingress.kubernetes.io/proxy-read-timeout: "60"
    nginx.ingress.kubernetes.io/proxy-send-timeout: "60"
    
    # WebSocketæ”¯æŒ
    nginx.ingress.kubernetes.io/websocket-services: "go-app-service"
    
    # TLSé…ç½®
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
spec:
  ingressClassName: nginx
  
  # TLSé…ç½®
  tls:
  - hosts:
    - api.example.com
    secretName: api-example-tls
  
  # è·¯ç”±è§„åˆ™
  rules:
  - host: api.example.com
    http:
      paths:
      # APIè·¯ç”±
      - path: /api/v1
        pathType: Prefix
        backend:
          service:
            name: go-app-service
            port:
              number: 80
      
      # WebSocketè·¯ç”±
      - path: /ws
        pathType: Prefix
        backend:
          service:
            name: go-app-service
            port:
              number: 80
```

---

## ç¬¬äº”éƒ¨åˆ†ï¼šHelmåŒ…ç®¡ç†

### å®æˆ˜æ¡ˆä¾‹8ï¼šHelm Chartç»“æ„

```text
go-app/
â”œâ”€â”€ Chart.yaml           # Chartå…ƒæ•°æ®
â”œâ”€â”€ values.yaml          # é»˜è®¤é…ç½®å€¼
â”œâ”€â”€ values-prod.yaml     # ç”Ÿäº§ç¯å¢ƒé…ç½®
â”œâ”€â”€ values-dev.yaml      # å¼€å‘ç¯å¢ƒé…ç½®
â”œâ”€â”€ charts/              # ä¾èµ–Chart
â”œâ”€â”€ templates/           # K8sèµ„æºæ¨¡æ¿
â”‚   â”œâ”€â”€ NOTES.txt        # å®‰è£…è¯´æ˜
â”‚   â”œâ”€â”€ _helpers.tpl     # è¾…åŠ©å‡½æ•°
â”‚   â”œâ”€â”€ deployment.yaml
â”‚   â”œâ”€â”€ service.yaml
â”‚   â”œâ”€â”€ ingress.yaml
â”‚   â”œâ”€â”€ configmap.yaml
â”‚   â”œâ”€â”€ secret.yaml
â”‚   â”œâ”€â”€ hpa.yaml         # æ°´å¹³è‡ªåŠ¨ä¼¸ç¼©
â”‚   â””â”€â”€ tests/           # æµ‹è¯•
â”‚       â””â”€â”€ test-connection.yaml
â””â”€â”€ .helmignore
```

```yaml
# Chart.yaml
apiVersion: v2
name: go-app
description: Go Application Helm Chart
type: application
version: 1.0.0
appVersion: "1.0.0"

dependencies:
- name: postgresql
  version: "12.1.0"
  repository: "https://charts.bitnami.com/bitnami"
  condition: postgresql.enabled
- name: redis
  version: "17.0.0"
  repository: "https://charts.bitnami.com/bitnami"
  condition: redis.enabled

---
# values.yaml
replicaCount: 3

image:
  repository: myregistry.com/go-app
  pullPolicy: IfNotPresent
  tag: "v1.0.0"

service:
  type: ClusterIP
  port: 80
  targetPort: 8080

ingress:
  enabled: true
  className: nginx
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt-prod
  hosts:
    - host: api.example.com
      paths:
        - path: /
          pathType: Prefix
  tls:
    - secretName: api-example-tls
      hosts:
        - api.example.com

resources:
  requests:
    cpu: 100m
    memory: 128Mi
  limits:
    cpu: 500m
    memory: 512Mi

autoscaling:
  enabled: true
  minReplicas: 2
  maxReplicas: 10
  targetCPUUtilizationPercentage: 80
  targetMemoryUtilizationPercentage: 80

postgresql:
  enabled: true
  auth:
    username: myapp
    password: changeme
    database: myapp

redis:
  enabled: true
  architecture: standalone

---
# templates/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: {{ include "go-app.fullname" . }}
  labels:
    {{- include "go-app.labels" . | nindent 4 }}
spec:
  replicas: {{ .Values.replicaCount }}
  selector:
    matchLabels:
      {{- include "go-app.selectorLabels" . | nindent 6 }}
  template:
    metadata:
      labels:
        {{- include "go-app.selectorLabels" . | nindent 8 }}
    spec:
      containers:
      - name: {{ .Chart.Name }}
        image: "{{ .Values.image.repository }}:{{ .Values.image.tag | default .Chart.AppVersion }}"
        imagePullPolicy: {{ .Values.image.pullPolicy }}
        ports:
        - name: http
          containerPort: {{ .Values.service.targetPort }}
          protocol: TCP
        resources:
          {{- toYaml .Values.resources | nindent 12 }}
```

---

## ğŸ¯ æ€»ç»“

### äº‘åŸç”Ÿæ ¸å¿ƒè¦ç‚¹

1. **Docker** - å®¹å™¨åŒ–ã€å¤šé˜¶æ®µæ„å»ºã€é•œåƒä¼˜åŒ–
2. **Kubernetes** - Pod/Deployment/Service/Ingress
3. **é…ç½®ç®¡ç†** - ConfigMap/Secret
4. **æœåŠ¡å‘ç°** - Service/DNS
5. **è´Ÿè½½å‡è¡¡** - ClusterIP/LoadBalancer
6. **è‡ªåŠ¨ä¼¸ç¼©** - HPA/VPA
7. **Helm** - åŒ…ç®¡ç†ã€ç‰ˆæœ¬æ§åˆ¶
8. **ç›‘æ§** - Prometheus/Grafana
9. **æ—¥å¿—** - ELK/Loki
10. **CI/CD** - GitLab CI/GitHub Actions

### æœ€ä½³å®è·µæ¸…å•

```text
âœ… ä½¿ç”¨å¤šé˜¶æ®µæ„å»ºå‡å°é•œåƒä½“ç§¯
âœ… érootç”¨æˆ·è¿è¡Œå®¹å™¨
âœ… è®¾ç½®å¥åº·æ£€æŸ¥å’Œå°±ç»ªæ¢é’ˆ
âœ… åˆç†é…ç½®èµ„æºè¯·æ±‚å’Œé™åˆ¶
âœ… ä½¿ç”¨ConfigMapç®¡ç†é…ç½®
âœ… ä½¿ç”¨Secretç®¡ç†æ•æ„Ÿä¿¡æ¯
âœ… å®æ–½æ°´å¹³è‡ªåŠ¨ä¼¸ç¼©ï¼ˆHPAï¼‰
âœ… é…ç½®æ»šåŠ¨æ›´æ–°ç­–ç•¥
âœ… å®æ–½ç›‘æ§å’Œå‘Šè­¦
âœ… è®°å½•ç»“æ„åŒ–æ—¥å¿—
```

---

**æ–‡æ¡£ç‰ˆæœ¬**: v14.0  

<div align="center">

Made with â¤ï¸ for Cloud Native Developers

[â¬† å›åˆ°é¡¶éƒ¨](#äº‘åŸç”Ÿéƒ¨ç½²æ·±åº¦å®æˆ˜æŒ‡å—)

</div>

---

**æ–‡æ¡£ç»´æŠ¤è€…**: Go Documentation Team  
**æœ€åæ›´æ–°**: 2025å¹´10æœˆ20æ—¥  
**æ–‡æ¡£çŠ¶æ€**: å®Œæˆ  
**é€‚ç”¨ç‰ˆæœ¬**: Go 1.25.3+
