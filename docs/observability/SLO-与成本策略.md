---
title: 可观测性 SLO 与成本控制策略
slug: observability-slo-and-cost
topic: observability
level: operations
goVersion: 1.21+
lastReviewed: 2025-09-15
owner: sre-team
status: active
---

## 目标

- 在保障用户体验与问题定位效率的前提下，使用采样与治理手段将可观测性成本保持在可控范围内。

## SLI/SLO 模型

- 核心 SLI：可用性、延迟（P50/P90/P99）、错误率（5xx）、饱和度（资源利用）
- 目标 SLO（API 类）：30 天 99.9% 可用性；P99 < 500ms；错误率 < 0.1%
- 误差预算：0.1%（~43.2 分钟/月）：用于灰度、演练与突发容错

## 告警策略

- 多层级：
  - L1：用户影响（SLO 违约趋势，误差预算消耗率激增）
  - L2：服务退化（错误率/延迟阈值连续超标）
  - L3：信号中断（No Data、Exporter/队列异常、采样器异常）
- 降噪：
  - 使用滑窗/静默窗口与聚合
  - 仅在双信号（错误率+延迟）同时异常时升级

## 采样与基数治理

- 追踪采样：默认 1-5% Head；关键路径 100%；Collector Tail 采样对异常/高延迟提升
- 指标治理：限制标签（cardinality）与动态维度；长尾降级为事件/日志；避免 user-id、request-id 这类高基数标签
- 日志采样：按等级与路径采样；批量与压缩；敏感字段脱敏

## 存储与保留策略

- 热数据：Trace/Logs 3-7 天；Metrics 15-30 天（按业务）
- 温数据：降采样与聚合（汇总、直方图）
- 冷数据：归档到低成本存储（对象存储），仅离线分析使用

## 成本监控

- 指标：摄入速率、存储增长、查询 QPS/延迟、失败率
- 单位成本：每百万 span/日志条目/时间序列的成本；按团队或租户记账

## 变更与演练

- 应用变更需评估新增标签/事件对基数与成本影响
- 定期进行“可观测性失效演练”（禁用某 exporter/队列阻塞），验证回退与告警有效性


