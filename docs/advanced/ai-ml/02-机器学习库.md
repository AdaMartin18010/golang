# 机器学习库

**版本**: v1.0  
**更新日期**: 2025-10-29  
**适用于**: Go 1.25.3

---

## 📋 目录


- [1. 📖 概念介绍](#1-概念介绍)
- [🎯 GoLearn](#golearn)
  - [基础使用](#基础使用)
  - [决策树](#决策树)
- [🔢 Gorgonia (深度学习)](#gorgonia-深度学习)
- [📊 GoNum (数值计算)](#gonum-数值计算)
- [🧠 Neat (神经进化)](#neat-神经进化)
- [💡 实用工具](#实用工具)
  - [数据预处理](#数据预处理)
- [📚 相关资源](#相关资源)

## 1. 📖 概念介绍

虽然Go的ML生态不如Python丰富，但仍有优秀的纯Go机器学习库，适合生产环境部署。

---

## 🎯 GoLearn

### 基础使用

```go
import (
    "github.com/sjwhitworth/golearn/base"
    "github.com/sjwhitworth/golearn/evaluation"
    "github.com/sjwhitworth/golearn/knn"
)

func trainKNN() {
    // 加载数据
    rawData, _ := base.ParseCSVToInstances("datasets/iris.csv", true)
    
    // 分割训练和测试集
    trainData, testData := base.InstancesTrainTestSplit(rawData, 0.8)
    
    // 创建KNN分类器
    classifier := knn.NewKnnClassifier("euclidean", "linear", 2)
    
    // 训练
    classifier.Fit(trainData)
    
    // 预测
    predictions, _ := classifier.Predict(testData)
    
    // 评估
    confusionMat, _ := evaluation.GetConfusionMatrix(testData, predictions)
    fmt.Println(evaluation.GetSummary(confusionMat))
}
```

---

### 决策树

```go
import "github.com/sjwhitworth/golearn/trees"

func trainDecisionTree() {
    data, _ := base.ParseCSVToInstances("data.csv", true)
    
    // 创建决策树
    tree := trees.NewID3DecisionTree(0.6)
    
    // 训练
    tree.Fit(data)
    
    // 预测
    predictions, _ := tree.Predict(data)
    
    // 准确率
    accuracy := evaluation.GetAccuracy(data, predictions)
    fmt.Printf("Accuracy: %.2f%%\n", accuracy*100)
}
```

---

## 🔢 Gorgonia (深度学习)

```go
import (
    "gorgonia.org/gorgonia"
    "gorgonia.org/tensor"
)

// 简单神经网络
type NN struct {
    g      *gorgonia.ExprGraph
    w0, w1 *gorgonia.Node
    
    pred   *gorgonia.Node
    loss   *gorgonia.Node
}

func NewNN(input, hidden, output int) *NN {
    g := gorgonia.NewGraph()
    
    // 权重
    w0 := gorgonia.NewMatrix(g, tensor.Float64, 
        gorgonia.WithShape(input, hidden), 
        gorgonia.WithName("w0"),
        gorgonia.WithInit(gorgonia.GlorotU(1.0)))
    
    w1 := gorgonia.NewMatrix(g, tensor.Float64,
        gorgonia.WithShape(hidden, output),
        gorgonia.WithName("w1"),
        gorgonia.WithInit(gorgonia.GlorotU(1.0)))
    
    return &NN{
        g:  g,
        w0: w0,
        w1: w1,
    }
}

func (nn *NN) Forward(x *gorgonia.Node) (*gorgonia.Node, error) {
    // 第一层
    h := gorgonia.Must(gorgonia.Mul(x, nn.w0))
    h = gorgonia.Must(gorgonia.Tanh(h))
    
    // 输出层
    out := gorgonia.Must(gorgonia.Mul(h, nn.w1))
    nn.pred = out
    
    return out, nil
}
```

---

## 📊 GoNum (数值计算)

```go
import (
    "gonum.org/v1/gonum/mat"
    "gonum.org/v1/gonum/stat"
)

// 线性回归
func linearRegression(X, y []float64) (slope, intercept float64) {
    alpha, beta := stat.LinearRegression(X, y, nil, false)
    return beta, alpha
}

// 矩阵运算
func matrixOperations() {
    // 创建矩阵
    data := []float64{1, 2, 3, 4, 5, 6}
    m := mat.NewDense(2, 3, data)
    
    // 转置
    var mt mat.Dense
    mt.CloneFrom(m.T())
    
    // 矩阵乘法
    n := mat.NewDense(3, 2, []float64{1, 2, 3, 4, 5, 6})
    var result mat.Dense
    result.Mul(m, n)
    
    fmt.Printf("Result:\n%.2f\n", mat.Formatted(&result))
}

// 统计分析
func statisticalAnalysis(data []float64) {
    mean := stat.Mean(data, nil)
    variance := stat.Variance(data, nil)
    stdDev := stat.StdDev(data, nil)
    
    fmt.Printf("Mean: %.2f\n", mean)
    fmt.Printf("Variance: %.2f\n", variance)
    fmt.Printf("Std Dev: %.2f\n", stdDev)
}
```

---

## 🧠 Neat (神经进化)

```go
import "github.com/jinyeom/neat"

func evolveNN() {
    // 创建配置
    config := neat.DefaultConfig()
    config.PopSize = 150
    
    // 创建种群
    pop := neat.NewPopulation(config, 2, 1)
    
    // 进化
    for gen := 0; gen < 100; gen++ {
        for _, org := range pop.Organisms {
            // 评估适应度
            fitness := evaluateFitness(org.Phenotype)
            org.Fitness = fitness
        }
        
        pop.Epoch()
        
        best := pop.BestOrganism()
        fmt.Printf("Gen %d: Best fitness = %.2f\n", gen, best.Fitness)
    }
}

func evaluateFitness(network *neat.Network) float64 {
    // XOR问题
    inputs := [][]float64{{0, 0}, {0, 1}, {1, 0}, {1, 1}}
    expected := []float64{0, 1, 1, 0}
    
    fitness := 4.0
    for i, input := range inputs {
        output := network.Activate(input)
        error := math.Abs(expected[i] - output[0])
        fitness -= error
    }
    
    return fitness * fitness
}
```

---

## 💡 实用工具

### 数据预处理

```go
// 归一化
func normalize(data []float64) []float64 {
    min, max := minMax(data)
    result := make([]float64, len(data))
    
    for i, v := range data {
        result[i] = (v - min) / (max - min)
    }
    
    return result
}

// 标准化
func standardize(data []float64) []float64 {
    mean := stat.Mean(data, nil)
    stdDev := stat.StdDev(data, nil)
    
    result := make([]float64, len(data))
    for i, v := range data {
        result[i] = (v - mean) / stdDev
    }
    
    return result
}
```

---

## 📚 相关资源

- [GoLearn](https://github.com/sjwhitworth/golearn)
- [Gorgonia](https://gorgonia.org/)
- [GoNum](https://www.gonum.org/)

**下一步**: [03-深度学习框架](./03-深度学习框架.md)

---

**最后更新**: 2025-10-29

