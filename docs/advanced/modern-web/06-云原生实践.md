# äº‘åŸç”Ÿå®è·µ

**ç‰ˆæœ¬**: v1.0
**æ›´æ–°æ—¥æœŸ**: 2025-10-29
**é€‚ç”¨äº**: Go 1.25.3

---

## ğŸ“‹ ç›®å½•

- [äº‘åŸç”Ÿå®è·µ](#äº‘åŸç”Ÿå®è·µ)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1. ğŸ“– 12-Factor App](#1--12-factor-app)
  - [ğŸ³ å®¹å™¨åŒ–](#-å®¹å™¨åŒ–)
  - [â˜¸ï¸ Kuberneteséƒ¨ç½²](#ï¸-kuberneteséƒ¨ç½²)
  - [ğŸ”§ é…ç½®ç®¡ç†](#-é…ç½®ç®¡ç†)
  - [ğŸ“Š å¯è§‚æµ‹æ€§ä¸‰æ”¯æŸ±](#-å¯è§‚æµ‹æ€§ä¸‰æ”¯æŸ±)
  - [ğŸš€ GitOps](#-gitops)
  - [ğŸ“š ç›¸å…³èµ„æº](#-ç›¸å…³èµ„æº)

## 1. ğŸ“– 12-Factor App

```go
// 1. é…ç½®ä»ç¯å¢ƒå˜é‡è¯»å–
type Config struct {
    Port       string
    DBHost     string
    DBPassword string
}

func LoadConfig() *Config {
    return &Config{
        Port:       getEnv("PORT", "8080"),
        DBHost:     os.Getenv("DB_HOST"),
        DBPassword: os.Getenv("DB_PASSWORD"),
    }
}

// 2. æ— çŠ¶æ€æœåŠ¡
type StatelessService struct {
    cache *redis.Client // å¤–éƒ¨çŠ¶æ€å­˜å‚¨
}

// 3. å¥åº·æ£€æŸ¥
func (s *Service) Health(w http.ResponseWriter, r *http.Request) {
    if err := s.db.Ping(); err != nil {
        w.WriteHeader(http.StatusServiceUnavailable)
        return
    }
    w.WriteHeader(http.StatusOK)
}

// 4. ä¼˜é›…å…³é—­
func gracefulShutdown(server *http.Server) {
    quit := make(chan os.Signal, 1)
    signal.Notify(quit, syscall.SIGTERM, syscall.SIGINT)
    <-quit

    ctx, cancel := context.WithTimeout(context.Background(), 30*time.Second)
    defer cancel()

    server.Shutdown(ctx)
}
```

---

## ğŸ³ å®¹å™¨åŒ–

```dockerfile
# å¤šé˜¶æ®µæ„å»º
FROM golang:1.21-alpine AS builder
WORKDIR /app
COPY . .
RUN go mod download
RUN CGO_ENABLED=0 GOOS=linux go build -o main .

FROM alpine:latest
RUN apk --no-cache add ca-certificates
WORKDIR /root/
COPY --from=builder /app/main .
EXPOSE 8080
CMD ["./main"]
```

---

## â˜¸ï¸ Kuberneteséƒ¨ç½²

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: myapp
spec:
  replicas: 3
  selector:
    matchLabels:
      app: myapp
  template:
    metadata:
      labels:
        app: myapp
    spec:
      containers:
      - name: myapp
        image: myapp:latest
        ports:
        - containerPort: 8080
        env:
        - name: DB_HOST
          valueFrom:
            secretKeyRef:
              name: db-secret
              key: host
        livenessProbe:
          httpGet:
            path: /health
            port: 8080
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /ready
            port: 8080
          initialDelaySeconds: 5
          periodSeconds: 5
        resources:
          limits:
            memory: "512Mi"
            cpu: "500m"
          requests:
            memory: "256Mi"
            cpu: "250m"
```

---

## ğŸ”§ é…ç½®ç®¡ç†

```go
import "github.com/spf13/viper"

func initConfig() {
    viper.SetConfigName("config")
    viper.SetConfigType("yaml")
    viper.AddConfigPath("/etc/myapp/")
    viper.AddConfigPath(".")

    viper.AutomaticEnv() // ç¯å¢ƒå˜é‡ä¼˜å…ˆ

    if err := viper.ReadInConfig(); err != nil {
        log.Fatal(err)
    }
}

// ä½¿ç”¨
dbHost := viper.GetString("database.host")
port := viper.GetInt("server.port")
```

---

## ğŸ“Š å¯è§‚æµ‹æ€§ä¸‰æ”¯æŸ±

```go
// 1. æ—¥å¿—
import "go.uber.org/zap"

logger, _ := zap.NewProduction()
defer logger.Sync()

logger.Info("user login",
    zap.String("user_id", "123"),
    zap.String("ip", "192.168.1.1"),
)

// 2. æŒ‡æ ‡ (Metrics)
import "github.com/prometheus/client_golang/prometheus"

httpRequestsTotal := prometheus.NewCounterVec(
    prometheus.CounterOpts{
        Name: "http_requests_total",
    },
    []string{"method", "endpoint", "status"},
)

// 3. è¿½è¸ª (Tracing)
import "go.opentelemetry.io/otel"

tracer := otel.Tracer("my-service")
ctx, span := tracer.Start(r.Context(), "handle-request")
defer span.End()
```

---

## ğŸš€ GitOps

```yaml
# argocd-app.yaml
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: myapp
spec:
  project: default
  source:
    repoURL: https://github.com/myorg/myapp
    targetRevision: HEAD
    path: k8s
  destination:
    server: https://kubernetes.default.svc
    namespace: production
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
```

---

## ğŸ“š ç›¸å…³èµ„æº

- [12 Factor App](https://12factor.net/)
- [Cloud Native Computing Foundation](https://www.cncf.io/)
- [Kubernetes Best Practices](https://kubernetes.io/docs/concepts/)

---
