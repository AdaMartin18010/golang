# Go é¡¹ç›®æ¡†æ¶é›†æˆæ€»ç»“

**ç‰ˆæœ¬**: v1.0
**æ›´æ–°æ—¥æœŸ**: 2025-11-11
**é€‚ç”¨äº**: Go 1.25.3

---

## ğŸ“‹ ç›®å½•

- [Go é¡¹ç›®æ¡†æ¶é›†æˆæ€»ç»“](#go-é¡¹ç›®æ¡†æ¶é›†æˆæ€»ç»“)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1. æ¡†æ¶æ¦‚è§ˆ](#1-æ¡†æ¶æ¦‚è§ˆ)
  - [2. æ¨¡å—é›†æˆå…³ç³»](#2-æ¨¡å—é›†æˆå…³ç³»)
  - [3. ä½¿ç”¨åœºæ™¯](#3-ä½¿ç”¨åœºæ™¯)
  - [4. æœ€ä½³å®è·µ](#4-æœ€ä½³å®è·µ)

---

## 1. æ¡†æ¶æ¦‚è§ˆ

### 1.1 æ ¸å¿ƒæ¡†æ¶å±‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æ ¸å¿ƒæ¡†æ¶å±‚ (pkg/)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  errors      - ç»Ÿä¸€é”™è¯¯å¤„ç†              â”‚
â”‚  http/response - ç»Ÿä¸€å“åº”æ ¼å¼            â”‚
â”‚  logger      - ç»“æ„åŒ–æ—¥å¿—                â”‚
â”‚  validator   - è¯·æ±‚éªŒè¯                  â”‚
â”‚  auth/jwt    - JWTè®¤è¯                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 ä¸­é—´ä»¶å±‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       ä¸­é—´ä»¶å±‚ (middleware/)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  auth        - è®¤è¯æˆæƒ                  â”‚
â”‚  ratelimit   - é™æµ                      â”‚
â”‚  circuitbreaker - ç†”æ–­å™¨                 â”‚
â”‚  tracing     - è¯·æ±‚è¿½è¸ª                  â”‚
â”‚  metrics     - æ€§èƒ½ç›‘æ§                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 æœåŠ¡æ²»ç†å±‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       æœåŠ¡æ²»ç†å±‚ (pkg/)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  registry    - æœåŠ¡æ³¨å†Œä¸­å¿ƒ              â”‚
â”‚  loadbalancer - è´Ÿè½½å‡è¡¡                 â”‚
â”‚  health      - å¥åº·æ£€æŸ¥                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.4 é«˜çº§åŠŸèƒ½å±‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       é«˜çº§åŠŸèƒ½å±‚ (pkg/)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  transaction - äº‹åŠ¡ç®¡ç†                  â”‚
â”‚  eventbus    - äº‹ä»¶æ€»çº¿                  â”‚
â”‚  rbac        - æƒé™æ§åˆ¶                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. æ¨¡å—é›†æˆå…³ç³»

### 2.1 å…¸å‹HTTPæœåŠ¡é›†æˆ

```
HTTP Request
    â†“
[è¿½è¸ªä¸­é—´ä»¶] â†’ OpenTelemetry
    â†“
[æ€§èƒ½ç›‘æ§ä¸­é—´ä»¶] â†’ Metrics
    â†“
[è®¤è¯ä¸­é—´ä»¶] â†’ JWT â†’ RBAC
    â†“
[é™æµä¸­é—´ä»¶] â†’ Rate Limiter
    â†“
[ç†”æ–­å™¨ä¸­é—´ä»¶] â†’ Circuit Breaker
    â†“
[Handler] â†’ [éªŒè¯å™¨] â†’ [ä¸šåŠ¡é€»è¾‘]
    â†“
[äº‹åŠ¡ç®¡ç†] â†’ [æ•°æ®åº“]
    â†“
[äº‹ä»¶æ€»çº¿] â†’ [äº‹ä»¶å¤„ç†]
    â†“
[å“åº”æ ¼å¼] â†’ HTTP Response
```

### 2.2 æ¨¡å—ä¾èµ–å…³ç³»

```
errors â† http/response â† middleware
  â†‘
validator â† middleware
  â†‘
auth/jwt â† middleware/auth
  â†‘
rbac â† middleware/auth
  â†‘
logger â† middleware/tracing, middleware/metrics
  â†‘
registry â† loadbalancer
  â†‘
health â† registry
  â†‘
transaction â† infrastructure
  â†‘
eventbus â† domain, application
```

---

## 3. ä½¿ç”¨åœºæ™¯

### 3.1 å¾®æœåŠ¡åœºæ™¯

```go
// æœåŠ¡æ³¨å†Œ
reg := registry.NewInMemoryRegistry()
service := &registry.Service{...}
reg.Register(ctx, service)

// æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡
lb := loadbalancer.NewRoundRobin()
selector := loadbalancer.NewServiceSelector(reg, lb, "user-service")
service, _ := selector.Select(ctx)

// å¥åº·æ£€æŸ¥
checker := health.NewHealthChecker()
checker.Register(health.NewSimpleCheck("database", ...))
```

### 3.2 äº‹ä»¶é©±åŠ¨åœºæ™¯

```go
// å‘å¸ƒé¢†åŸŸäº‹ä»¶
event := eventbus.NewEvent("order.created", orderData)
eventBus.Publish(event)

// è®¢é˜…äº‹ä»¶
eventBus.Subscribe("order.created", func(ctx context.Context, event eventbus.Event) error {
    // å‘é€é€šçŸ¥
    // æ›´æ–°åº“å­˜
    // è®°å½•æ—¥å¿—
    return nil
})
```

### 3.3 äº‹åŠ¡å¤„ç†åœºæ™¯

```go
// åœ¨äº‹åŠ¡ä¸­æ‰§è¡Œå¤šä¸ªæ“ä½œ
manager.WithTransaction(ctx, func(ctx context.Context) error {
    tx, _ := transaction.GetSQLTx(ctx)

    // æ“ä½œ1
    tx.Exec("UPDATE accounts SET balance = balance - $1", amount)

    // æ“ä½œ2
    tx.Exec("UPDATE accounts SET balance = balance + $1", amount)

    // å¦‚æœä»»ä½•æ“ä½œå¤±è´¥ï¼Œè‡ªåŠ¨å›æ»š
    return nil
})
```

---

## 4. æœ€ä½³å®è·µ

### 4.1 ä¸­é—´ä»¶é¡ºåº

```go
r.Use(middleware.TracingMiddleware(...))      // 1. è¿½è¸ªï¼ˆæœ€å¤–å±‚ï¼‰
r.Use(middleware.MetricsMiddleware(...))      // 2. ç›‘æ§
r.Use(middleware.RateLimitMiddleware(...))    // 3. é™æµ
r.Use(middleware.CircuitBreakerMiddleware(...)) // 4. ç†”æ–­
r.Use(middleware.AuthMiddleware(...))         // 5. è®¤è¯ï¼ˆæœ€å†…å±‚ï¼‰
```

### 4.2 é”™è¯¯å¤„ç†æµç¨‹

```
ä¸šåŠ¡é€»è¾‘é”™è¯¯
    â†“
è½¬æ¢ä¸º AppError (pkg/errors)
    â†“
æ·»åŠ è¿½è¸ªIDå’Œè¯¦ç»†ä¿¡æ¯
    â†“
é€šè¿‡å“åº”æ ¼å¼è¿”å› (pkg/http/response)
    â†“
è®°å½•æ—¥å¿— (pkg/logger)
```

### 4.3 æƒé™æ§åˆ¶æµç¨‹

```
HTTP Request
    â†“
è®¤è¯ä¸­é—´ä»¶ â†’ æå–JWT â†’ éªŒè¯Token
    â†“
æ³¨å…¥ç”¨æˆ·ä¿¡æ¯åˆ°Context
    â†“
RBACä¸­é—´ä»¶ â†’ æ£€æŸ¥æƒé™
    â†“
Handler â†’ æ‰§è¡Œä¸šåŠ¡é€»è¾‘
```

---

## 5. å·¥å…·åº“é›†æˆ

### 5.1 é‡è¯•å·¥å…·é›†æˆ

```go
import "github.com/yourusername/golang/pkg/utils/retry"

strategy := retry.DefaultExponentialBackoff()
err := retry.Retry(ctx, strategy, func(ctx context.Context) error {
    return httpClient.Get(ctx, "/api/users", nil)
})
```

### 5.2 ç¼“å­˜å·¥å…·é›†æˆ

```go
import "github.com/yourusername/golang/pkg/utils/cache"

cache := cache.NewMemoryCache()
value, err := cache.GetOrSet(ctx, "key", 5*time.Minute, func() (interface{}, error) {
    return fetchFromDatabase()
})
```

### 5.3 HTTPå®¢æˆ·ç«¯é›†æˆ

```go
import "github.com/yourusername/golang/pkg/utils/httpclient"

client := httpclient.NewClient(httpclient.Config{
    BaseURL: "https://api.example.com",
    Timeout: 30 * time.Second,
})
resp, err := client.Get(ctx, "/users", nil)
```

---

## 6. ç›¸å…³èµ„æº

- [æ¡†æ¶ä½¿ç”¨æŒ‡å—](./00-æ¡†æ¶ä½¿ç”¨æŒ‡å—.md)
- [æ¡†æ¶æ‹“å±•è®¡åˆ’](./00-æ¡†æ¶æ‹“å±•è®¡åˆ’.md)
- [æ¡†æ¶æ‹“å±•è¿›åº¦æŠ¥å‘Š](./00-æ¡†æ¶æ‹“å±•è¿›åº¦æŠ¥å‘Š.md)
- [æ¡†æ¶åŠŸèƒ½æ€»è§ˆ](./00-æ¡†æ¶åŠŸèƒ½æ€»è§ˆ.md)

---

**æ›´æ–°æ—¥æœŸ**: 2025-11-11
