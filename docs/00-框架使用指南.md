# Go é¡¹ç›®æ¡†æ¶ä½¿ç”¨æŒ‡å—

**ç‰ˆæœ¬**: v1.0
**æ›´æ–°æ—¥æœŸ**: 2025-11-11
**é€‚ç”¨äº**: Go 1.25.3

---

## ğŸ“‹ ç›®å½•

- [Go é¡¹ç›®æ¡†æ¶ä½¿ç”¨æŒ‡å—](#go-é¡¹ç›®æ¡†æ¶ä½¿ç”¨æŒ‡å—)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1. å¿«é€Ÿå¼€å§‹](#1-å¿«é€Ÿå¼€å§‹)
  - [2. æ ¸å¿ƒæ¡†æ¶ä½¿ç”¨](#2-æ ¸å¿ƒæ¡†æ¶ä½¿ç”¨)
  - [3. ä¸­é—´ä»¶ä½¿ç”¨](#3-ä¸­é—´ä»¶ä½¿ç”¨)
  - [4. æœåŠ¡æ²»ç†ä½¿ç”¨](#4-æœåŠ¡æ²»ç†ä½¿ç”¨)
  - [5. é«˜çº§åŠŸèƒ½ä½¿ç”¨](#5-é«˜çº§åŠŸèƒ½ä½¿ç”¨)
  - [6. å®Œæ•´ç¤ºä¾‹](#6-å®Œæ•´ç¤ºä¾‹)

---

## 1. å¿«é€Ÿå¼€å§‹

### 1.1 å®‰è£…ä¾èµ–

```bash
go mod tidy
```

### 1.2 åŸºæœ¬é¡¹ç›®ç»“æ„

```
golang/
â”œâ”€â”€ cmd/              # åº”ç”¨ç¨‹åºå…¥å£
â”œâ”€â”€ internal/         # å†…éƒ¨ä»£ç 
â”‚   â”œâ”€â”€ domain/       # é¢†åŸŸå±‚
â”‚   â”œâ”€â”€ application/  # åº”ç”¨å±‚
â”‚   â”œâ”€â”€ infrastructure/ # åŸºç¡€è®¾æ–½å±‚
â”‚   â””â”€â”€ interfaces/   # æ¥å£å±‚
â”œâ”€â”€ pkg/              # å¯å¤ç”¨çš„åŒ…
â”‚   â”œâ”€â”€ errors/       # é”™è¯¯å¤„ç†
â”‚   â”œâ”€â”€ http/         # HTTPå“åº”
â”‚   â”œâ”€â”€ logger/       # æ—¥å¿—
â”‚   â”œâ”€â”€ validator/    # éªŒè¯
â”‚   â”œâ”€â”€ auth/         # è®¤è¯
â”‚   â”œâ”€â”€ registry/     # æœåŠ¡æ³¨å†Œ
â”‚   â”œâ”€â”€ loadbalancer/ # è´Ÿè½½å‡è¡¡
â”‚   â”œâ”€â”€ health/       # å¥åº·æ£€æŸ¥
â”‚   â”œâ”€â”€ transaction/  # äº‹åŠ¡ç®¡ç†
â”‚   â”œâ”€â”€ eventbus/     # äº‹ä»¶æ€»çº¿
â”‚   â””â”€â”€ rbac/         # æƒé™æ§åˆ¶
â””â”€â”€ docs/             # æ–‡æ¡£
```

---

## 2. æ ¸å¿ƒæ¡†æ¶ä½¿ç”¨

### 2.1 é”™è¯¯å¤„ç†

```go
import "github.com/yourusername/golang/pkg/errors"

// åˆ›å»ºé”™è¯¯
err := errors.NewNotFoundError("user", "123")

// æ·»åŠ è¯¦ç»†ä¿¡æ¯
err.WithDetails("field", "value")

// æ·»åŠ è¿½è¸ªID
err.WithTraceID("trace-123")

// æ£€æŸ¥æ˜¯å¦å¯é‡è¯•
if err.IsRetryable() {
    // é‡è¯•é€»è¾‘
}
```

### 2.2 å“åº”æ ¼å¼

```go
import "github.com/yourusername/golang/pkg/http/response"

// æˆåŠŸå“åº”
response.Success(w, http.StatusOK, data)

// é”™è¯¯å“åº”
response.Error(w, http.StatusNotFound, err)

// åˆ†é¡µå“åº”
response.Paginated(w, http.StatusOK, data, page, pageSize, total)
```

### 2.3 æ—¥å¿—è®°å½•

```go
import "github.com/yourusername/golang/pkg/logger"

// åˆ›å»ºæ—¥å¿—è®°å½•å™¨
log := logger.NewLogger(slog.LevelInfo)

// è®°å½•æ—¥å¿—
log.Info("Application started")
log.WithContext(ctx).Info("Processing request")
log.LogRequest(ctx, "GET", "/users", 200, duration)
```

### 2.4 è¯·æ±‚éªŒè¯

```go
import "github.com/yourusername/golang/pkg/validator"

type CreateUserRequest struct {
    Name  string `validate:"required,min=2,max=50"`
    Email string `validate:"required,email"`
}

validator := validator.NewValidator()
if !validator.Validate(req) {
    validationErrors := validator.ValidateStruct(req)
    // å¤„ç†éªŒè¯é”™è¯¯
}
```

### 2.5 JWTè®¤è¯

```go
import "github.com/yourusername/golang/pkg/auth/jwt"

// åˆ›å»ºJWTç®¡ç†å™¨
j, _ := jwt.NewJWT(jwt.Config{
    SecretKey:      "your-secret-key",
    SigningMethod:  "HS256",
    AccessTokenTTL: 15 * time.Minute,
})

// ç”ŸæˆToken
token, _ := j.GenerateAccessToken("user-123", "john", []string{"user"}, "john@example.com")

// éªŒè¯Token
claims, _ := j.ValidateToken(token)
```

---

## 3. ä¸­é—´ä»¶ä½¿ç”¨

### 3.1 è®¤è¯æˆæƒä¸­é—´ä»¶

```go
import "github.com/yourusername/golang/pkg/http/chi/middleware"

r.Use(middleware.AuthMiddleware(middleware.AuthConfig{
    JWT:       jwtManager,
    SkipPaths: []string{"/public", "/health"},
}))

// è§’è‰²æƒé™æ§åˆ¶
r.Group(func(r chi.Router) {
    r.Use(middleware.RequireRole("admin"))
    r.Delete("/users/{id}", deleteUserHandler)
})
```

### 3.2 é™æµä¸­é—´ä»¶

```go
r.Use(middleware.RateLimitMiddleware(middleware.RateLimitConfig{
    RequestsPerSecond: 100,
    Burst:             200,
    Window:            time.Second,
}))
```

### 3.3 ç†”æ–­å™¨ä¸­é—´ä»¶

```go
breaker := middleware.NewCircuitBreaker("api", middleware.CircuitBreakerConfig{
    FailureThreshold: 5,
    SuccessThreshold: 2,
    Timeout:          60 * time.Second,
})

r.Use(middleware.CircuitBreakerMiddleware(breaker))
```

### 3.4 è¿½è¸ªä¸­é—´ä»¶

```go
r.Use(middleware.TracingMiddleware(middleware.TracingConfig{
    TracerName:     "api-server",
    ServiceName:    "user-service",
    ServiceVersion: "v1.0.0",
}))
```

### 3.5 æ€§èƒ½ç›‘æ§ä¸­é—´ä»¶

```go
metrics := middleware.NewMetrics()
r.Use(middleware.MetricsMiddleware(metrics))
r.Get("/metrics", middleware.MetricsHandler(metrics))
```

---

## 4. æœåŠ¡æ²»ç†ä½¿ç”¨

### 4.1 æœåŠ¡æ³¨å†Œ

```go
import "github.com/yourusername/golang/pkg/registry"

reg := registry.NewInMemoryRegistry()

service := &registry.Service{
    ID:      "user-service-1",
    Name:    "user-service",
    Address: "localhost",
    Port:    8080,
    TTL:     30 * time.Second,
}

reg.Register(context.Background(), service)
```

### 4.2 è´Ÿè½½å‡è¡¡

```go
import "github.com/yourusername/golang/pkg/loadbalancer"

lb := loadbalancer.NewRoundRobin()
selector := loadbalancer.NewServiceSelector(reg, lb, "user-service")

service, _ := selector.Select(context.Background())
```

### 4.3 å¥åº·æ£€æŸ¥

```go
import "github.com/yourusername/golang/pkg/health"

checker := health.NewHealthChecker()

checker.Register(health.NewSimpleCheck("database", func(ctx context.Context) error {
    return db.Ping(ctx)
}))

status := checker.OverallStatus(context.Background())
```

---

## 5. é«˜çº§åŠŸèƒ½ä½¿ç”¨

### 5.1 äº‹åŠ¡ç®¡ç†

```go
import "github.com/yourusername/golang/pkg/transaction"

manager := transaction.NewSQLTransactionManager(db)

err := manager.WithTransaction(ctx, func(ctx context.Context) error {
    tx, _ := transaction.GetSQLTx(ctx)
    // ä½¿ç”¨äº‹åŠ¡æ‰§è¡Œæ“ä½œ
    _, err := tx.Exec("INSERT INTO users (name) VALUES ($1)", "John")
    return err
})
```

### 5.2 äº‹ä»¶æ€»çº¿

```go
import "github.com/yourusername/golang/pkg/eventbus"

eb := eventbus.NewEventBus(100)
eb.Start()
defer eb.Stop()

// è®¢é˜…äº‹ä»¶
eb.Subscribe("user.created", func(ctx context.Context, event eventbus.Event) error {
    // å¤„ç†äº‹ä»¶
    return nil
})

// å‘å¸ƒäº‹ä»¶
event := eventbus.NewEvent("user.created", map[string]interface{}{
    "user_id": "123",
})
eb.Publish(event)
```

### 5.3 RBACæƒé™æ§åˆ¶

```go
import "github.com/yourusername/golang/pkg/rbac"

rbac := rbac.NewRBAC()

// åˆ›å»ºæƒé™å’Œè§’è‰²
permission := &rbac.Permission{
    ID:       "perm_read_users",
    Resource: "users",
    Action:   "read",
}
rbac.AddPermission(permission)

role := &rbac.Role{ID: "role_admin", Name: "admin"}
rbac.AddRole(role)
rbac.AssignPermission("role_admin", "perm_read_users")

// æ£€æŸ¥æƒé™
user := &rbac.User{ID: "user1", Roles: []string{"role_admin"}}
enforcer := rbac.NewEnforcer(rbac)
err := enforcer.Enforce(user, "users", "read")
```

---

## 6. å®Œæ•´ç¤ºä¾‹

### 6.1 å®Œæ•´çš„HTTPæœåŠ¡

```go
package main

import (
    "context"
    "net/http"
    "time"

    "github.com/go-chi/chi/v5"
    "github.com/yourusername/golang/internal/interfaces/http/chi/middleware"
    "github.com/yourusername/golang/pkg/auth/jwt"
    "github.com/yourusername/golang/pkg/logger"
    "github.com/yourusername/golang/pkg/health"
)

func main() {
    // åˆ›å»ºæ—¥å¿—è®°å½•å™¨
    log := logger.NewLogger(slog.LevelInfo)

    // åˆ›å»ºJWTç®¡ç†å™¨
    jwtManager, _ := jwt.NewJWT(jwt.Config{
        SecretKey:      "your-secret-key",
        SigningMethod:  "HS256",
        AccessTokenTTL: 15 * time.Minute,
    })

    // åˆ›å»ºå¥åº·æ£€æŸ¥å™¨
    healthChecker := health.NewHealthChecker()
    healthChecker.Register(health.NewSimpleCheck("database", func(ctx context.Context) error {
        // æ£€æŸ¥æ•°æ®åº“è¿æ¥
        return nil
    }))

    // åˆ›å»ºè·¯ç”±
    r := chi.NewRouter()

    // ä¸­é—´ä»¶
    r.Use(middleware.TracingMiddleware(middleware.TracingConfig{
        ServiceName: "api-server",
    }))

    metrics := middleware.NewMetrics()
    r.Use(middleware.MetricsMiddleware(metrics))

    r.Use(middleware.AuthMiddleware(middleware.AuthConfig{
        JWT:       jwtManager,
        SkipPaths: []string{"/health", "/metrics"},
    }))

    // å¥åº·æ£€æŸ¥
    r.Get("/health", func(w http.ResponseWriter, r *http.Request) {
        status := healthChecker.OverallStatus(r.Context())
        if status == health.StatusHealthy {
            w.WriteHeader(http.StatusOK)
        } else {
            w.WriteHeader(http.StatusServiceUnavailable)
        }
    })

    // æŒ‡æ ‡
    r.Get("/metrics", middleware.MetricsHandler(metrics))

    // APIè·¯ç”±
    r.Route("/api/v1", func(r chi.Router) {
        r.Get("/users", getUserHandler)
        r.Post("/users", createUserHandler)
    })

    // å¯åŠ¨æœåŠ¡å™¨
    log.Info("Server starting on :8080")
    http.ListenAndServe(":8080", r)
}
```

---

## 7. ç›¸å…³èµ„æº

- [æ¡†æ¶æ‹“å±•è®¡åˆ’](./00-æ¡†æ¶æ‹“å±•è®¡åˆ’.md)
- [æ¡†æ¶æ‹“å±•è¿›åº¦æŠ¥å‘Š](./00-æ¡†æ¶æ‹“å±•è¿›åº¦æŠ¥å‘Š.md)
- [é¡¹ç›®ç»“æ„è§„èŒƒ](./00-é¡¹ç›®æ–‡æ¡£ç»“æ„è§„èŒƒ.md)

---

**æ›´æ–°æ—¥æœŸ**: 2025-11-11
