# 核心包概览

**难度**: 中级 | **预计阅读**: 20分钟 | **前置知识**: Go基础语法

---

## 📋 目录

- [1. 📖 概念介绍](#1--概念介绍)
- [2. 🎯 核心知识点](#2--核心知识点)
- [3. 💡 最佳实践](#3--最佳实践)
- [4. 📚 相关资源](#4--相关资源)

---

## 1. 📖 概念介绍

Go标准库的核心包提供了最基础、最常用的功能。掌握这些包是使用Go的前提。本文介绍6个最核心的包：fmt、errors、io、os、time、flag。

---

## 2. 🎯 核心知识点

### 1. fmt - 格式化输入输出

#### 格式化输出

```go
package main

import "fmt"

func fmtExample() {
    // Printf - 格式化输出
    name := "Alice"
    age := 25
    fmt.Printf("Name: %s, Age: %d\n", name, age)
    
    // Println - 输出并换行
    fmt.Println("Hello", "World")
    
    // Print - 输出不换行
    fmt.Print("Hello ")
    fmt.Print("World\n")
    
    // Sprintf - 格式化字符串
    msg := fmt.Sprintf("User %s is %d years old", name, age)
    fmt.Println(msg)
    
    // Fprintf - 输出到Writer
    fmt.Fprintf(os.Stdout, "Writing to stdout\n")
}
```

#### 常用格式化动词

```go
package main

import "fmt"

func formatVerbs() {
    // 通用
    fmt.Printf("%v\n", struct{Name string}{"Alice"})  // {Alice}
    fmt.Printf("%+v\n", struct{Name string}{"Alice"}) // {Name:Alice}
    fmt.Printf("%#v\n", struct{Name string}{"Alice"}) // struct { Name string }{Name:"Alice"}
    fmt.Printf("%T\n", 42)                             // int
    
    // 布尔
    fmt.Printf("%t\n", true) // true
    
    // 整数
    fmt.Printf("%d\n", 42)   // 42 (十进制)
    fmt.Printf("%b\n", 42)   // 101010 (二进制)
    fmt.Printf("%o\n", 42)   // 52 (八进制)
    fmt.Printf("%x\n", 42)   // 2a (十六进制小写)
    fmt.Printf("%X\n", 42)   // 2A (十六进制大写)
    
    // 浮点数
    fmt.Printf("%f\n", 3.14)   // 3.140000
    fmt.Printf("%.2f\n", 3.14) // 3.14
    fmt.Printf("%e\n", 1234.0) // 1.234000e+03
    
    // 字符串
    fmt.Printf("%s\n", "hello") // hello
    fmt.Printf("%q\n", "hello") // "hello"
    fmt.Printf("%x\n", "hello") // 68656c6c6f
    
    // 指针
    i := 42
    fmt.Printf("%p\n", &i) // 0xc0000140a8
}
```

---

### 2. errors - 错误处理

#### 创建错误

```go
package main

import (
    "errors"
    "fmt"
)

func errorsExample() {
    // 创建简单错误
    err := errors.New("something went wrong")
    fmt.Println(err)
    
    // 使用fmt.Errorf创建格式化错误
    err = fmt.Errorf("failed to open file: %s", "config.json")
    fmt.Println(err)
}
```

#### 错误包装（Go 1.13+）

```go
package main

import (
    "errors"
    "fmt"
)

var ErrNotFound = errors.New("not found")

func readConfig() error {
    return fmt.Errorf("read config: %w", ErrNotFound)
}

func errorWrapping() {
    err := readConfig()
    
    // 检查错误类型
    if errors.Is(err, ErrNotFound) {
        fmt.Println("Config not found")
    }
    
    // 展开错误
    fmt.Printf("Error: %v\n", err)
    fmt.Printf("Unwrapped: %v\n", errors.Unwrap(err))
}
```

---

### 3. io - I/O原语

#### Reader和Writer接口

```go
package main

import (
    "fmt"
    "io"
    "strings"
)

func ioExample() {
    // Reader示例
    reader := strings.NewReader("Hello, Reader")
    buf := make([]byte, 8)
    
    for {
        n, err := reader.Read(buf)
        if err == io.EOF {
            break
        }
        fmt.Printf("Read %d bytes: %s\n", n, buf[:n])
    }
    
    // 使用ioutil读取全部
    reader = strings.NewReader("Hello, World")
    data, _ := io.ReadAll(reader)
    fmt.Printf("Read all: %s\n", data)
}
```

#### 常用I/O函数

```go
package main

import (
    "io"
    "strings"
)

func ioFunctions() {
    src := strings.NewReader("Hello, World")
    dst := &strings.Builder{}
    
    // 复制
    io.Copy(dst, src)
    
    // 限制读取
    limited := io.LimitReader(src, 5)
    
    // MultiReader
    r1 := strings.NewReader("Hello ")
    r2 := strings.NewReader("World")
    mr := io.MultiReader(r1, r2)
}
```

---

### 4. os - 操作系统功能

#### 文件操作

```go
package main

import (
    "fmt"
    "os"
)

func osExample() {
    // 创建文件
    file, err := os.Create("test.txt")
    if err != nil {
        panic(err)
    }
    defer file.Close()
    
    // 写入
    file.WriteString("Hello, OS\n")
    
    // 读取文件
    data, _ := os.ReadFile("test.txt")
    fmt.Printf("Content: %s", data)
    
    // 删除文件
    os.Remove("test.txt")
}
```

#### 环境变量

```go
package main

import (
    "fmt"
    "os"
)

func envExample() {
    // 设置环境变量
    os.Setenv("MY_VAR", "my_value")
    
    // 获取环境变量
    value := os.Getenv("MY_VAR")
    fmt.Println(value)
    
    // 获取所有环境变量
    for _, env := range os.Environ() {
        fmt.Println(env)
    }
}
```

---

### 5. time - 时间处理

#### 时间操作

```go
package main

import (
    "fmt"
    "time"
)

func timeExample() {
    // 当前时间
    now := time.Now()
    fmt.Println("Now:", now)
    
    // 格式化时间
    fmt.Println("Formatted:", now.Format("2006-01-02 15:04:05"))
    fmt.Println("RFC3339:", now.Format(time.RFC3339))
    
    // 解析时间
    t, _ := time.Parse("2006-01-02", "2025-10-27")
    fmt.Println("Parsed:", t)
    
    // 时间运算
    future := now.Add(24 * time.Hour)
    fmt.Println("Tomorrow:", future)
    
    // 时间比较
    if future.After(now) {
        fmt.Println("Future is after now")
    }
    
    // Duration
    duration := future.Sub(now)
    fmt.Println("Duration:", duration)
}
```

#### 定时器和Ticker

```go
package main

import (
    "fmt"
    "time"
)

func timerExample() {
    // Timer - 一次性定时器
    timer := time.NewTimer(2 * time.Second)
    fmt.Println("Waiting...")
    <-timer.C
    fmt.Println("Timer expired")
    
    // Ticker - 周期性定时器
    ticker := time.NewTicker(500 * time.Millisecond)
    defer ticker.Stop()
    
    count := 0
    for t := range ticker.C {
        fmt.Println("Tick at", t)
        count++
        if count >= 3 {
            break
        }
    }
}
```

---

### 6. flag - 命令行参数解析

```go
package main

import (
    "flag"
    "fmt"
)

func flagExample() {
    // 定义标志
    var name string
    var age int
    var verbose bool
    
    flag.StringVar(&name, "name", "Guest", "Your name")
    flag.IntVar(&age, "age", 0, "Your age")
    flag.BoolVar(&verbose, "verbose", false, "Verbose output")
    
    // 解析
    flag.Parse()
    
    // 使用
    fmt.Printf("Name: %s\n", name)
    fmt.Printf("Age: %d\n", age)
    fmt.Printf("Verbose: %v\n", verbose)
    
    // 剩余参数
    fmt.Printf("Args: %v\n", flag.Args())
}

// 使用：go run main.go -name Alice -age 25 -verbose arg1 arg2
```

---

## 4. 📚 相关资源

- [fmt Package](https://pkg.go.dev/fmt)
- [errors Package](https://pkg.go.dev/errors)
- [io Package](https://pkg.go.dev/io)
- [os Package](https://pkg.go.dev/os)
- [time Package](https://pkg.go.dev/time)
- [flag Package](https://pkg.go.dev/flag)

---

**最后更新**: 2025-10-27

