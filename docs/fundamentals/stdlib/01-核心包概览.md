# Go标准库核心包概览

> **简介**: Go标准库核心包完整指南，包括常用包介绍、使用示例和最佳实践

> **版本**: Go 1.25.3  
> **难度**: ⭐⭐⭐  
> **标签**: #标准库 #核心包 #常用API

---

## 📋 目录
- [1. fmt包 - 格式化I/O](#fmt包)
- [2. io包 - I/O原语](#io包)
- [3. os包 - 操作系统功能](#os包)
- [4. time包 - 时间处理](#time包)
- [5. strings包 - 字符串操作](#strings包)
- [6. strconv包 - 类型转换](#strconv包)

---

## 1. fmt包 - 格式化I/O

### 输出函数

```go
package main

import "fmt"

func main() {
    name := "Alice"
    age := 25
    
    // Print - 标准输出
    fmt.Print("Hello ")
    fmt.Print("World\n")
    
    // Println - 带换行
    fmt.Println("Hello", "World")
    
    // Printf - 格式化输出
    fmt.Printf("Name: %s, Age: %d\n", name, age)
    
    // Sprintf - 格式化为字符串
    message := fmt.Sprintf("Name: %s, Age: %d", name, age)
    fmt.Println(message)
    
    // Fprintf - 输出到Writer
    fmt.Fprintf(os.Stdout, "Hello %s!\n", name)
}
```

---

### 格式化动词

```go
// 通用
%v    // 默认格式
%+v   // 带字段名的结构体
%#v   // Go语法表示
%T    // 类型
%%    // 百分号

// 布尔
%t    // true/false

// 整数
%d    // 十进制
%b    // 二进制
%o    // 八进制
%x    // 十六进制（小写）
%X    // 十六进制（大写）

// 浮点数
%f    // 小数
%e    // 科学计数法（小写）
%E    // 科学计数法（大写）
%g    // 自动选择%f或%e

// 字符串
%s    // 字符串
%q    // 带引号的字符串
%x    // 十六进制编码

// 指针
%p    // 指针地址

// 示例
type User struct {
    Name string
    Age  int
}

user := User{"Alice", 25}
fmt.Printf("%v\n", user)   // {Alice 25}
fmt.Printf("%+v\n", user)  // {Name:Alice Age:25}
fmt.Printf("%#v\n", user)  // main.User{Name:"Alice", Age:25}
fmt.Printf("%T\n", user)   // main.User

num := 42
fmt.Printf("%d\n", num)    // 42
fmt.Printf("%b\n", num)    // 101010
fmt.Printf("%o\n", num)    // 52
fmt.Printf("%x\n", num)    // 2a
```

---

### 输入函数

```go
// Scan - 从标准输入读取
var name string
var age int
fmt.Print("Enter name and age: ")
fmt.Scan(&name, &age)

// Scanf - 格式化输入
fmt.Print("Enter name and age (name age): ")
fmt.Scanf("%s %d", &name, &age)

// Scanln - 读取一行
fmt.Print("Enter name: ")
fmt.Scanln(&name)

// Fscan - 从Reader读取
reader := strings.NewReader("Alice 25")
fmt.Fscan(reader, &name, &age)

// Sscan - 从字符串读取
input := "Alice 25"
fmt.Sscan(input, &name, &age)
```

---

## 2. io包 - I/O原语

### 基本接口

```go
// Reader接口
type Reader interface {
    Read(p []byte) (n int, err error)
}

// Writer接口
type Writer interface {
    Write(p []byte) (n int, err error)
}

// Closer接口
type Closer interface {
    Close() error
}

// ReadWriteCloser组合接口
type ReadWriteCloser interface {
    Reader
    Writer
    Closer
}
```

---

### 常用函数

```go
// Copy - 复制数据
src := strings.NewReader("Hello, World!")
dst := &bytes.Buffer{}
n, err := io.Copy(dst, src)
fmt.Println(dst.String())  // Hello, World!

// CopyN - 复制指定字节数
src = strings.NewReader("Hello, World!")
dst = &bytes.Buffer{}
io.CopyN(dst, src, 5)
fmt.Println(dst.String())  // Hello

// ReadAll - 读取全部数据
src = strings.NewReader("Hello, World!")
data, err := io.ReadAll(src)
fmt.Println(string(data))  // Hello, World!

// ReadFull - 读取指定长度
src = strings.NewReader("Hello")
buf := make([]byte, 5)
io.ReadFull(src, buf)
fmt.Println(string(buf))  // Hello

// WriteString - 写入字符串
buf := &bytes.Buffer{}
io.WriteString(buf, "Hello")
```

---

### 实用工具

```go
// LimitReader - 限制读取
src := strings.NewReader("Hello, World!")
limited := io.LimitReader(src, 5)
data, _ := io.ReadAll(limited)
fmt.Println(string(data))  // Hello

// MultiReader - 多个Reader
r1 := strings.NewReader("Hello ")
r2 := strings.NewReader("World")
multi := io.MultiReader(r1, r2)
data, _ = io.ReadAll(multi)
fmt.Println(string(data))  // Hello World

// TeeReader - 读取时同时写入
src = strings.NewReader("Hello")
buf := &bytes.Buffer{}
tee := io.TeeReader(src, buf)
data, _ = io.ReadAll(tee)
fmt.Println(string(data))    // Hello
fmt.Println(buf.String())    // Hello

// Pipe - 管道
pr, pw := io.Pipe()
go func() {
    defer pw.Close()
    pw.Write([]byte("Hello from pipe"))
}()
data, _ = io.ReadAll(pr)
fmt.Println(string(data))
```

---

## 3. os包 - 操作系统功能

### 文件操作

```go
// 创建文件
file, err := os.Create("test.txt")
if err != nil {
    log.Fatal(err)
}
defer file.Close()

// 写入文件
file.WriteString("Hello, World!")

// 读取文件
data, err := os.ReadFile("test.txt")
fmt.Println(string(data))

// 写入文件（简便方法）
os.WriteFile("test.txt", []byte("Hello"), 0644)

// 打开文件
file, err = os.Open("test.txt")
defer file.Close()

// 读取内容
buf := make([]byte, 100)
n, err := file.Read(buf)
fmt.Println(string(buf[:n]))

// 追加模式
file, err = os.OpenFile("test.txt", os.O_APPEND|os.O_WRONLY, 0644)
file.WriteString("\nNew line")
```

---

### 目录操作

```go
// 创建目录
os.Mkdir("mydir", 0755)

// 创建多级目录
os.MkdirAll("path/to/dir", 0755)

// 删除文件/目录
os.Remove("test.txt")

// 删除目录及其内容
os.RemoveAll("mydir")

// 重命名
os.Rename("old.txt", "new.txt")

// 读取目录
entries, err := os.ReadDir(".")
for _, entry := range entries {
    fmt.Println(entry.Name(), entry.IsDir())
}

// 获取文件信息
info, err := os.Stat("test.txt")
fmt.Println(info.Name())
fmt.Println(info.Size())
fmt.Println(info.ModTime())
fmt.Println(info.IsDir())

// 检查文件是否存在
if _, err := os.Stat("test.txt"); os.IsNotExist(err) {
    fmt.Println("File does not exist")
}
```

---

### 环境变量

```go
// 获取环境变量
home := os.Getenv("HOME")
fmt.Println(home)

// 设置环境变量
os.Setenv("MY_VAR", "value")

// 获取所有环境变量
for _, env := range os.Environ() {
    fmt.Println(env)
}

// 查找环境变量
value, exists := os.LookupEnv("HOME")
if exists {
    fmt.Println(value)
}
```

---

### 程序参数

```go
// 获取命令行参数
fmt.Println(os.Args)      // [./program arg1 arg2]
fmt.Println(os.Args[0])   // 程序名
fmt.Println(os.Args[1:])  // 参数列表

// 退出程序
os.Exit(0)  // 0表示成功
```

---

## 4. time包 - 时间处理

### 基本操作

```go
// 当前时间
now := time.Now()
fmt.Println(now)

// 创建时间
t := time.Date(2025, time.October, 28, 10, 30, 0, 0, time.UTC)
fmt.Println(t)

// 时间解析
t, err := time.Parse("2006-01-02", "2025-10-28")
t, err = time.Parse(time.RFC3339, "2025-10-28T10:30:00Z")

// 时间格式化
fmt.Println(now.Format("2006-01-02"))
fmt.Println(now.Format("2006-01-02 15:04:05"))
fmt.Println(now.Format(time.RFC3339))

// 时间组件
fmt.Println(now.Year())
fmt.Println(now.Month())
fmt.Println(now.Day())
fmt.Println(now.Hour())
fmt.Println(now.Minute())
fmt.Println(now.Second())
fmt.Println(now.Weekday())
```

---

### 时间计算

```go
now := time.Now()

// 时间增减
tomorrow := now.Add(24 * time.Hour)
yesterday := now.Add(-24 * time.Hour)
nextWeek := now.Add(7 * 24 * time.Hour)

// 时间差
duration := tomorrow.Sub(now)
fmt.Println(duration)  // 24h0m0s

// 时间比较
if now.Before(tomorrow) {
    fmt.Println("now is before tomorrow")
}

if now.After(yesterday) {
    fmt.Println("now is after yesterday")
}

if now.Equal(now) {
    fmt.Println("times are equal")
}

// Unix时间戳
timestamp := now.Unix()           // 秒
timestampMilli := now.UnixMilli() // 毫秒
timestampNano := now.UnixNano()   // 纳秒

// 从时间戳创建时间
t := time.Unix(timestamp, 0)
```

---

### 定时器

```go
// Sleep - 暂停
time.Sleep(2 * time.Second)

// Timer - 定时器
timer := time.NewTimer(2 * time.Second)
<-timer.C
fmt.Println("Timer expired")

// 取消定时器
timer = time.NewTimer(5 * time.Second)
timer.Stop()

// Ticker - 周期性定时器
ticker := time.NewTicker(1 * time.Second)
defer ticker.Stop()

for i := 0; i < 5; i++ {
    <-ticker.C
    fmt.Println("Tick", i)
}

// After - 简便方法
<-time.After(2 * time.Second)
fmt.Println("Done")

// AfterFunc - 延迟执行函数
time.AfterFunc(2*time.Second, func() {
    fmt.Println("Executed after 2 seconds")
})
```

---

## 5. strings包 - 字符串操作

### 常用函数

```go
s := "Hello, World!"

// 包含
strings.Contains(s, "World")  // true
strings.ContainsAny(s, "xyz") // false

// 前缀/后缀
strings.HasPrefix(s, "Hello") // true
strings.HasSuffix(s, "!")     // true

// 索引
strings.Index(s, "World")     // 7
strings.LastIndex(s, "o")     // 8

// 计数
strings.Count(s, "l")         // 3

// 分割
parts := strings.Split("a,b,c", ",")  // ["a", "b", "c"]
strings.SplitN("a,b,c", ",", 2)       // ["a", "b,c"]

// 连接
strings.Join([]string{"a", "b", "c"}, ",")  // "a,b,c"

// 替换
strings.Replace(s, "World", "Go", 1)   // 替换一次
strings.ReplaceAll(s, "l", "L")        // 替换所有

// 大小写
strings.ToUpper(s)    // "HELLO, WORLD!"
strings.ToLower(s)    // "hello, world!"
strings.Title(s)      // "Hello, World!"

// 修剪
strings.TrimSpace("  hello  ")      // "hello"
strings.Trim("!!hello!!", "!")      // "hello"
strings.TrimPrefix("hello", "he")   // "llo"
strings.TrimSuffix("hello", "lo")   // "hel"

// 重复
strings.Repeat("Go", 3)  // "GoGoGo"
```

---

### Builder - 高效字符串拼接

```go
var builder strings.Builder

builder.WriteString("Hello")
builder.WriteString(", ")
builder.WriteString("World")
builder.WriteByte('!')

result := builder.String()
fmt.Println(result)  // Hello, World!

// 预分配容量
builder.Reset()
builder.Grow(100)  // 预分配100字节
```

---

## 6. strconv包 - 类型转换

### 字符串转数字

```go
// Atoi - 字符串转int
i, err := strconv.Atoi("42")
fmt.Println(i)  // 42

// ParseInt - 字符串转int64
i64, err := strconv.ParseInt("42", 10, 64)

// ParseUint - 字符串转uint64
u64, err := strconv.ParseUint("42", 10, 64)

// ParseFloat - 字符串转float64
f, err := strconv.ParseFloat("3.14", 64)

// ParseBool - 字符串转bool
b, err := strconv.ParseBool("true")  // true
b, err = strconv.ParseBool("1")      // true
b, err = strconv.ParseBool("false")  // false
```

---

### 数字转字符串

```go
// Itoa - int转字符串
s := strconv.Itoa(42)  // "42"

// FormatInt - int64转字符串
s = strconv.FormatInt(42, 10)  // 十进制
s = strconv.FormatInt(42, 2)   // 二进制
s = strconv.FormatInt(42, 16)  // 十六进制

// FormatUint - uint64转字符串
s = strconv.FormatUint(42, 10)

// FormatFloat - float64转字符串
s = strconv.FormatFloat(3.14159, 'f', 2, 64)  // "3.14"
s = strconv.FormatFloat(3.14159, 'e', 2, 64)  // "3.14e+00"

// FormatBool - bool转字符串
s = strconv.FormatBool(true)   // "true"
```

---

### 引号处理

```go
// Quote - 添加引号
s := strconv.Quote("Hello\nWorld")  // "\"Hello\\nWorld\""

// Unquote - 去除引号
s, err := strconv.Unquote(`"Hello\nWorld"`)  // "Hello\nWorld"

// QuoteToASCII - 转义为ASCII
s = strconv.QuoteToASCII("你好")  // "\u4f60\u597d"
```

---

## 🎯 使用建议

### 1. 选择合适的包

```go
// 简单字符串操作 → strings
if strings.Contains(s, "hello") {
    // ...
}

// 复杂字符串处理 → regexp
re := regexp.MustCompile(`\d+`)
matches := re.FindAllString(s, -1)

// 类型转换 → strconv
num, _ := strconv.Atoi(s)

// 格式化输出 → fmt
fmt.Printf("Value: %d\n", num)
```

---

### 2. 性能考虑

```go
// ❌ 低效：字符串拼接
s := ""
for i := 0; i < 1000; i++ {
    s += "x"  // 每次创建新字符串
}

// ✅ 高效：使用Builder
var builder strings.Builder
for i := 0; i < 1000; i++ {
    builder.WriteString("x")
}
s := builder.String()
```

---

## 🔗 相关资源

- [bufio包](./02-bufio包.md)
- [encoding/json包](./03-json包.md)
- [net/http包](./04-http包.md)

---

**最后更新**: 2025-10-28  
**Go版本**: 1.25.3
