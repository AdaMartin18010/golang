# ä¾èµ–ç®¡ç†

> ğŸ“š **ç®€ä»‹**
>
> æœ¬æ–‡å…¨é¢ä»‹ç»Goæ¨¡å—çš„ä¾èµ–ç®¡ç†å®è·µï¼ŒåŒ…æ‹¬ä¾èµ–æ·»åŠ ã€æ›´æ–°ã€æ›¿æ¢ã€å†²çªè§£å†³ç­‰æ ¸å¿ƒæ“ä½œã€‚å¸®åŠ©å¼€å‘è€…é«˜æ•ˆç®¡ç†é¡¹ç›®ä¾èµ–ï¼Œé¿å…å¸¸è§é—®é¢˜ã€‚
>
> é€šè¿‡æœ¬æ–‡ï¼Œæ‚¨å°†æŒæ¡ä¾èµ–ç®¡ç†çš„æœ€ä½³å®è·µï¼Œæå‡é¡¹ç›®å¯ç»´æŠ¤æ€§ã€‚

---

## ğŸ“‹ ç›®å½•

- [ä¾èµ–ç®¡ç†](#ä¾èµ–ç®¡ç†)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [1. ğŸ“š ä¾èµ–ç®¡ç†æ¦‚è¿°](#1--ä¾èµ–ç®¡ç†æ¦‚è¿°)
    - [1.1 ä¾èµ–ç±»å‹](#11-ä¾èµ–ç±»å‹)
    - [1.2 ä¾èµ–è§£æ](#12-ä¾èµ–è§£æ)
  - [2. â• æ·»åŠ ä¾èµ–](#2--æ·»åŠ ä¾èµ–)
    - [2.1 è‡ªåŠ¨æ·»åŠ ](#21-è‡ªåŠ¨æ·»åŠ )
    - [2.2 æ‰‹åŠ¨æ·»åŠ ](#22-æ‰‹åŠ¨æ·»åŠ )
    - [2.3 æŒ‡å®šç‰ˆæœ¬](#23-æŒ‡å®šç‰ˆæœ¬)
  - [3. ğŸ”„ æ›´æ–°ä¾èµ–](#3--æ›´æ–°ä¾èµ–)
    - [3.1 æ›´æ–°å•ä¸ªä¾èµ–](#31-æ›´æ–°å•ä¸ªä¾èµ–)
    - [3.2 æ‰¹é‡æ›´æ–°](#32-æ‰¹é‡æ›´æ–°)
    - [3.3 æŸ¥çœ‹å¯ç”¨æ›´æ–°](#33-æŸ¥çœ‹å¯ç”¨æ›´æ–°)
  - [4. ğŸ”§ ä¾èµ–æ›¿æ¢](#4--ä¾èµ–æ›¿æ¢)
    - [4.1 æœ¬åœ°æ›¿æ¢](#41-æœ¬åœ°æ›¿æ¢)
    - [4.2 è¿œç¨‹æ›¿æ¢](#42-è¿œç¨‹æ›¿æ¢)
    - [4.3 ä¸´æ—¶æ›¿æ¢](#43-ä¸´æ—¶æ›¿æ¢)
  - [5. âš ï¸ ä¾èµ–å†²çª](#5-ï¸-ä¾èµ–å†²çª)
    - [5.1 ç‰ˆæœ¬å†²çª](#51-ç‰ˆæœ¬å†²çª)
    - [5.2 é—´æ¥ä¾èµ–å†²çª](#52-é—´æ¥ä¾èµ–å†²çª)
  - [6. ğŸ§¹ ä¾èµ–æ¸…ç†](#6--ä¾èµ–æ¸…ç†)
    - [æ¸…ç†æœªä½¿ç”¨çš„ä¾èµ–](#æ¸…ç†æœªä½¿ç”¨çš„ä¾èµ–)
    - [æ¸…ç†æ¨¡å—ç¼“å­˜](#æ¸…ç†æ¨¡å—ç¼“å­˜)
    - [ä¸‹è½½æ‰€æœ‰ä¾èµ–](#ä¸‹è½½æ‰€æœ‰ä¾èµ–)
  - [7. ğŸ¯ æœ€ä½³å®è·µ](#7--æœ€ä½³å®è·µ)
    - [âœ… æ—¥å¸¸å¼€å‘](#-æ—¥å¸¸å¼€å‘)
    - [âœ… å›¢é˜Ÿåä½œ](#-å›¢é˜Ÿåä½œ)
    - [âœ… å®‰å…¨ç®¡ç†](#-å®‰å…¨ç®¡ç†)
  - [8. âš ï¸ å¸¸è§é—®é¢˜](#8-ï¸-å¸¸è§é—®é¢˜)
    - [Q1: å¦‚ä½•å¤„ç†"ambiguous import"é”™è¯¯ï¼Ÿ](#q1-å¦‚ä½•å¤„ç†ambiguous-importé”™è¯¯)
    - [Q2: replaceåœ¨å‘å¸ƒæ—¶åº”è¯¥ä¿ç•™å—ï¼Ÿ](#q2-replaceåœ¨å‘å¸ƒæ—¶åº”è¯¥ä¿ç•™å—)
    - [Q3: å¦‚ä½•å¼ºåˆ¶é‡æ–°ä¸‹è½½ä¾èµ–ï¼Ÿ](#q3-å¦‚ä½•å¼ºåˆ¶é‡æ–°ä¸‹è½½ä¾èµ–)
    - [Q4: ä¾èµ–ä¸‹è½½æ…¢æ€ä¹ˆåŠï¼Ÿ](#q4-ä¾èµ–ä¸‹è½½æ…¢æ€ä¹ˆåŠ)
  - [9. ğŸ“š æ‰©å±•é˜…è¯»](#9--æ‰©å±•é˜…è¯»)
    - [å®˜æ–¹æ–‡æ¡£](#å®˜æ–¹æ–‡æ¡£)
    - [ç›¸å…³æ–‡æ¡£](#ç›¸å…³æ–‡æ¡£)
    - [å·¥å…·æ¨è](#å·¥å…·æ¨è)

## 1. ğŸ“š ä¾èµ–ç®¡ç†æ¦‚è¿°

### 1.1 ä¾èµ–ç±»å‹

**ç›´æ¥ä¾èµ–**ï¼š

- é¡¹ç›®ä»£ç ä¸­ç›´æ¥`import`çš„åŒ…
- åœ¨go.modä¸­æ˜¾å¼åˆ—å‡º

```go
require github.com/gin-gonic/gin v1.9.1
```

**é—´æ¥ä¾èµ–**ï¼š

- ç›´æ¥ä¾èµ–çš„ä¾èµ–
- æ ‡è®°ä¸º`// indirect`

```go
require github.com/gin-contrib/sse v0.1.0 // indirect
```

### 1.2 ä¾èµ–è§£æ

Goä½¿ç”¨**æœ€å°ç‰ˆæœ¬é€‰æ‹©**ï¼ˆMVSï¼‰ç®—æ³•ï¼š

```text
Aä¾èµ–B v1.2.0  â†’  é€‰æ‹© v1.3.0
Cä¾èµ–B v1.3.0  â†’  (æ»¡è¶³æ‰€æœ‰éœ€æ±‚çš„æœ€å°ç‰ˆæœ¬)
Dä¾èµ–B v1.1.0  â†’
```

---

## 2. â• æ·»åŠ ä¾èµ–

### 2.1 è‡ªåŠ¨æ·»åŠ 

**æœ€æ¨èçš„æ–¹å¼**ï¼šåœ¨ä»£ç ä¸­å¯¼å…¥ï¼Œç„¶åè¿è¡Œï¼š

```bash
# 1. åœ¨ä»£ç ä¸­æ·»åŠ import
import "github.com/gin-gonic/gin"

# 2. è‡ªåŠ¨æ·»åŠ ä¾èµ–
go mod tidy
```

**æµç¨‹**ï¼š

```mermaid
    A[ç¼–å†™ä»£ç ] --> B[importåŒ…]
    B --> C[go mod tidy]
    C --> D[ä¸‹è½½ä¾èµ–]
    D --> E[æ›´æ–°go.mod]
    E --> F[ç”Ÿæˆgo.sum]
```

### 2.2 æ‰‹åŠ¨æ·»åŠ 

```bash
# æ·»åŠ æœ€æ–°ç‰ˆæœ¬
go get github.com/gin-gonic/gin

# éªŒè¯æ·»åŠ 
go list -m github.com/gin-gonic/gin
```

### 2.3 æŒ‡å®šç‰ˆæœ¬

```bash
# ç‰¹å®šç‰ˆæœ¬
go get github.com/gin-gonic/gin@v1.9.1

# æœ€æ–°ç‰ˆæœ¬
go get github.com/gin-gonic/gin@latest

# ç‰¹å®šæäº¤
go get github.com/gin-gonic/gin@abc123

# ç‰¹å®šåˆ†æ”¯
go get github.com/gin-gonic/gin@main

# ç‰ˆæœ¬èŒƒå›´
go get 'github.com/gin-gonic/gin@>=v1.9.0'
```

---

## 3. ğŸ”„ æ›´æ–°ä¾èµ–

### 3.1 æ›´æ–°å•ä¸ªä¾èµ–

```bash
# æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬
go get -u github.com/gin-gonic/gin

# æ›´æ–°åˆ°æœ€æ–°æ¬¡ç‰ˆæœ¬ï¼ˆæ¨èï¼‰
go get -u=patch github.com/gin-gonic/gin

# æ›´æ–°åˆ°ç‰¹å®šç‰ˆæœ¬
go get github.com/gin-gonic/gin@v1.10.0
```

### 3.2 æ‰¹é‡æ›´æ–°

```bash
# æ›´æ–°æ‰€æœ‰ç›´æ¥ä¾èµ–
go get -u ./...

# æ›´æ–°æ‰€æœ‰ä¾èµ–ï¼ˆåŒ…æ‹¬é—´æ¥ï¼‰
go get -u all

# ä»…æ›´æ–°è¡¥ä¸ç‰ˆæœ¬ï¼ˆå®‰å…¨ï¼‰
go get -u=patch all
```

### 3.3 æŸ¥çœ‹å¯ç”¨æ›´æ–°

```bash
# æŸ¥çœ‹æ‰€æœ‰ä¾èµ–çš„å¯ç”¨æ›´æ–°
go list -u -m all

# è¾“å‡ºç¤ºä¾‹ï¼š
# github.com/gin-gonic/gin v1.9.1 [v1.10.0]
#                        â†‘ å½“å‰  â†‘ å¯ç”¨
```

**è§£è¯»è¾“å‡º**ï¼š

```text
æ¨¡å—è·¯å¾„ å½“å‰ç‰ˆæœ¬ [æœ€æ–°ç‰ˆæœ¬]
```

---

## 4. ğŸ”§ ä¾èµ–æ›¿æ¢

### 4.1 æœ¬åœ°æ›¿æ¢

**ç”¨äºæœ¬åœ°å¼€å‘**ï¼š

```go
// go.mod
replace github.com/myorg/lib => ../lib
```

**ä½¿ç”¨åœºæ™¯**ï¼š

- ğŸ”§ è°ƒè¯•ä¾èµ–åº“
- ğŸš€ å¼€å‘æœªå‘å¸ƒçš„åŠŸèƒ½
- ğŸ› æœ¬åœ°ä¿®å¤bug

**ç¤ºä¾‹**ï¼š

```bash
# é¡¹ç›®ç»“æ„
/workspace/
  â”œâ”€â”€ myproject/
  â”‚   â””â”€â”€ go.mod (replace github.com/myorg/lib => ../lib)
  â””â”€â”€ lib/
      â””â”€â”€ go.mod (module github.com/myorg/lib)

# åœ¨myprojectä¸­
go mod edit -replace github.com/myorg/lib=../lib
```

### 4.2 è¿œç¨‹æ›¿æ¢

**ä½¿ç”¨forkç‰ˆæœ¬**ï¼š

```go
// go.mod
replace github.com/original/pkg => github.com/fork/pkg v1.2.3
```

**ä½¿ç”¨åœºæ™¯**ï¼š

- ğŸ”„ ä½¿ç”¨è‡ªå·±çš„fork
- ğŸ› ç­‰å¾…ä¸Šæ¸¸åˆå¹¶ä¿®å¤
- ğŸ”€ é•¿æœŸç»´æŠ¤fork

### 4.3 ä¸´æ—¶æ›¿æ¢

**ä½¿ç”¨go.workè¿›è¡Œå¤šæ¨¡å—å¼€å‘**ï¼š

```bash
# åˆ›å»ºå·¥ä½œåŒº
go work init ./project1 ./project2

# go.workå†…å®¹
go 1.21

use (
    ./project1
    ./project2
)
```

**ä¼˜åŠ¿**ï¼š

- âœ… ä¸ä¿®æ”¹go.mod
- âœ… ä»…å½±å“æœ¬åœ°å¼€å‘
- âœ… ä¸æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶

---

## 5. âš ï¸ ä¾èµ–å†²çª

### 5.1 ç‰ˆæœ¬å†²çª

**é—®é¢˜**ï¼šä¸åŒä¾èµ–è¦æ±‚åŒä¸€ä¸ªåŒ…çš„ä¸åŒç‰ˆæœ¬

```text
Aä¾èµ–C v1.2.0
Bä¾èµ–C v1.5.0
```

**Goçš„è§£å†³æ–¹æ¡ˆ**ï¼šMVSé€‰æ‹©v1.5.0

**æ‰‹åŠ¨å¹²é¢„**ï¼š

```bash
# æŸ¥çœ‹ä¾èµ–æ ‘
go mod graph | grep package-name

# å¼ºåˆ¶ä½¿ç”¨ç‰¹å®šç‰ˆæœ¬
go mod edit -require=github.com/pkg/errors@v0.9.1
go mod tidy
```

### 5.2 é—´æ¥ä¾èµ–å†²çª

**æŸ¥çœ‹å®Œæ•´ä¾èµ–é“¾**ï¼š

```bash
# æŸ¥çœ‹ä¸ºä»€ä¹ˆéœ€è¦æŸä¸ªä¾èµ–
go mod why github.com/some/package

# è¾“å‡ºç¤ºä¾‹ï¼š
# github.com/myproject
# github.com/dep1
# github.com/dep2
# github.com/some/package
```

**è§£å†³æ–¹æ¡ˆ**ï¼š

```go
// go.mod
// ä½¿ç”¨replaceç»Ÿä¸€ç‰ˆæœ¬
replace github.com/conflict/pkg => github.com/conflict/pkg v1.2.3
```

---

## 6. ğŸ§¹ ä¾èµ–æ¸…ç†

### æ¸…ç†æœªä½¿ç”¨çš„ä¾èµ–

```bash
# è‡ªåŠ¨æ¸…ç†
go mod tidy

# éªŒè¯æ¸…ç†ç»“æœ
go mod verify
```

### æ¸…ç†æ¨¡å—ç¼“å­˜

```bash
# æ¸…ç†æ‰€æœ‰ç¼“å­˜
go clean -modcache

# æ¸…ç†ç‰¹å®šæ¨¡å—
go clean -modcache github.com/some/pkg
```

### ä¸‹è½½æ‰€æœ‰ä¾èµ–

```bash
# é¢„ä¸‹è½½ä¾èµ–ï¼ˆç”¨äºCI/CDï¼‰
go mod download

# ä¸‹è½½ç‰¹å®šä¾èµ–
go mod download github.com/gin-gonic/gin
```

---

## 7. ğŸ¯ æœ€ä½³å®è·µ

### âœ… æ—¥å¸¸å¼€å‘

1. **ä½¿ç”¨go mod tidy**

   ```bash
   # æ¯æ¬¡ä¿®æ”¹ä¾èµ–å
   go mod tidy
   ```

2. **å®šæœŸæ›´æ–°ä¾èµ–**

   ```bash
   # æ¯æœˆæ£€æŸ¥æ›´æ–°
   go list -u -m all

   # æ›´æ–°è¡¥ä¸ç‰ˆæœ¬
   go get -u=patch all
   go mod tidy
   ```

3. **æäº¤go.sum**

   ```bash
   git add go.mod go.sum
   git commit -m "Update dependencies"
   ```

4. **ä½¿ç”¨vendorç›®å½•ï¼ˆå¯é€‰ï¼‰**

   ```bash
   # åˆ›å»ºvendorç›®å½•
   go mod vendor

   # ä½¿ç”¨vendoræ„å»º
   go build -mod=vendor
   ```

### âœ… å›¢é˜Ÿåä½œ

1. **ç»Ÿä¸€Goç‰ˆæœ¬**

   ```go
   // go.mod
   go 1.21  // å›¢é˜Ÿç»Ÿä¸€ä½¿ç”¨
   ```

2. **æ–‡æ¡£åŒ–replace**

   ```go
   replace (
       // ä¸´æ—¶ä¿®å¤issue #123
       github.com/pkg/errors => github.com/fork/errors v0.9.1
   )
   ```

3. **CI/CDéªŒè¯**

   ```bash
   # .github/workflows/go.yml
   - name: Verify dependencies
     run: |
       go mod verify
       go mod tidy
       git diff --exit-code go.* || (echo "go.mod or go.sum is out of sync" && exit 1)
   ```

### âœ… å®‰å…¨ç®¡ç†

1. **å®šæœŸå®¡è®¡**

   ```bash
   # æ£€æŸ¥å·²çŸ¥æ¼æ´
   go list -json -m all | nancy sleuth

   # æˆ–ä½¿ç”¨
   govulncheck ./...
   ```

2. **é”å®šå…³é”®ä¾èµ–**

   ```go
   // å…³é”®å®‰å…¨ä¾èµ–ä½¿ç”¨ç²¾ç¡®ç‰ˆæœ¬
   require (
       golang.org/x/crypto v0.14.0
       golang.org/x/net v0.17.0
   )
   ```

3. **ä½¿ç”¨ç§æœ‰ä»£ç†**

   ```bash
   # .bashrc or .zshrc
   export GOPROXY=https://yourproxy.com,direct
   export GOPRIVATE=github.com/yourorg/*
   ```

---

## 8. âš ï¸ å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•å¤„ç†"ambiguous import"é”™è¯¯ï¼Ÿ

**é”™è¯¯**ï¼š

```text
ambiguous import: found package github.com/pkg/errors in multiple modules
```

**è§£å†³**ï¼š

```bash
# 1. æŸ¥çœ‹å†²çª
go mod graph | grep pkg/errors

# 2. é€‰æ‹©ä¸€ä¸ªç‰ˆæœ¬
go get github.com/pkg/errors@v0.9.1

# 3. æ¸…ç†
go mod tidy
```

### Q2: replaceåœ¨å‘å¸ƒæ—¶åº”è¯¥ä¿ç•™å—ï¼Ÿ

**A**: è§†æƒ…å†µè€Œå®šï¼š

âœ… **ä¿ç•™**ï¼š

- ä¿®å¤ä¸Šæ¸¸bugçš„ä¸´æ—¶æ–¹æ¡ˆ
- ä½¿ç”¨forkç‰ˆæœ¬

âŒ **åˆ é™¤**ï¼š

- æœ¬åœ°å¼€å‘è·¯å¾„ï¼ˆ`../local/path`ï¼‰
- ä¸´æ—¶è°ƒè¯•

### Q3: å¦‚ä½•å¼ºåˆ¶é‡æ–°ä¸‹è½½ä¾èµ–ï¼Ÿ

```bash
# æ¸…é™¤ç¼“å­˜
go clean -modcache

# é‡æ–°ä¸‹è½½
go mod download

# æˆ–
rm -rf $GOPATH/pkg/mod
go mod download
```

### Q4: ä¾èµ–ä¸‹è½½æ…¢æ€ä¹ˆåŠï¼Ÿ

**æ–¹æ¡ˆ1ï¼šä½¿ç”¨ä»£ç†**:

```bash
export GOPROXY=https://goproxy.cn,direct
```

**æ–¹æ¡ˆ2ï¼šä½¿ç”¨vendor**:

```bash
go mod vendor
go build -mod=vendor
```

---

## 9. ğŸ“š æ‰©å±•é˜…è¯»

### å®˜æ–¹æ–‡æ¡£

- [Managing dependencies](https://go.dev/doc/modules/managing-dependencies)
- [go modå‘½ä»¤](https://go.dev/ref/mod#go-mod-download)

### ç›¸å…³æ–‡æ¡£

- [01-Go-Modulesç®€ä»‹.md](./01-Go-Modulesç®€ä»‹.md)
- [02-go-modæ–‡ä»¶è¯¦è§£.md](./02-go-modæ–‡ä»¶è¯¦è§£.md)
- [04-è¯­ä¹‰åŒ–ç‰ˆæœ¬.md](./04-è¯­ä¹‰åŒ–ç‰ˆæœ¬.md)
- [05-go-modå‘½ä»¤.md](./05-go-modå‘½ä»¤.md)

### å·¥å…·æ¨è

- [govulncheck](https://pkg.go.dev/golang.org/x/vuln/cmd/govulncheck) - æ¼æ´æ£€æŸ¥
- [go-mod-outdated](https://github.com/psampaz/go-mod-outdated) - è¿‡æ—¶ä¾èµ–æ£€æŸ¥
- [nancy](https://github.com/sonatype-nexus-community/nancy) - ä¾èµ–å®¡è®¡

---

**æ–‡æ¡£ç»´æŠ¤è€…**: Go Documentation Team
**æœ€åæ›´æ–°**: 2025-10-29
**æ–‡æ¡£çŠ¶æ€**: å®Œæˆ
**é€‚ç”¨ç‰ˆæœ¬**: Go 1.21+
