# 依赖管理

> 📚 **简介**
>
> 本文详细讲解 Go Modules 中的依赖管理操作，包括添加、更新、删除依赖，以及依赖升级和降级的最佳实践。掌握这些技能对于维护健康的项目依赖至关重要。
>
> 通过本文，您将学会如何高效管理项目依赖。

<!-- TOC START -->
## 📋 目录

- [添加依赖](#添加依赖)
- [更新依赖](#更新依赖)
- [删除依赖](#删除依赖)
- [依赖查询](#依赖查询)
- [依赖清理](#依赖清理)
- [最佳实践](#最佳实践)
- [常见问题](#常见问题)
<!-- TOC END -->

---

## 📦 添加依赖

### 方法 1: 自动添加

```bash
# 导入代码后自动添加
import "github.com/gin-gonic/gin"

# 运行 go mod tidy
go mod tidy
```

### 方法 2: 使用 go get

```bash
# 添加最新版本
go get github.com/gin-gonic/gin

# 添加特定版本
go get github.com/gin-gonic/gin@v1.9.1

# 添加特定分支
go get github.com/gin-gonic/gin@master

# 添加特定提交
go get github.com/gin-gonic/gin@abc123
```

---

## 🔄 更新依赖

### 更新单个依赖

```bash
# 更新到最新版本
go get -u github.com/gin-gonic/gin

# 更新到特定版本
go get github.com/gin-gonic/gin@v1.10.0
```

### 更新所有依赖

```bash
# 更新所有直接和间接依赖
go get -u ./...

# 仅更新次版本和修订版本
go get -u=patch ./...
```

---

## 🗑️ 删除依赖

### 手动删除

```bash
# 1. 从代码中移除导入
# 2. 运行 tidy 清理
go mod tidy
```

### go.mod 中删除

```bash
# 手动编辑 go.mod，删除 require 行
# 然后运行
go mod tidy
```

---

## 🔍 依赖查询

### 查看可用版本

```bash
go list -m -versions github.com/gin-gonic/gin
```

### 查看依赖树

```bash
go mod graph
```

### 查看特定包的依赖

```bash
go mod why github.com/gin-gonic/gin
```

---

## 🧹 依赖清理

```bash
# 清理未使用的依赖
go mod tidy

# 清理模块缓存
go clean -modcache

# 验证依赖
go mod verify
```

---

## 🎯 最佳实践

1. **定期更新**: 每月检查并更新依赖
2. **版本锁定**: 生产环境使用固定版本
3. **测试充分**: 更新后运行完整测试
4. **小步迭代**: 一次更新少量依赖

---

## ❓ 常见问题

### Q: 如何回退依赖版本？

```bash
go get github.com/package@v1.0.0
```

### Q: 如何处理依赖冲突？

```bash
go mod graph | grep package
go get github.com/package@v1.2.3
```

---

## 🔗 相关链接

- [go.mod 文件详解](./02-go-mod文件详解.md)
- [go mod 命令](./05-go-mod命令.md)
- [语义化版本](./04-语义化版本.md)

---

**文档维护者**: Go Documentation Team  
**最后更新**: 2025年10月20日  
**文档状态**: 完成  
**适用版本**: Go 1.21+
